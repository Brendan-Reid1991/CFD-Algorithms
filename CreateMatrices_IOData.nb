(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    184194,       5031]
NotebookOptionsPosition[    181888,       4984]
NotebookOutlinePosition[    182223,       4999]
CellTagsIndexPosition[    182180,       4996]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Run This Section", "Subsection",
 CellChangeTimes->{{3.7737778791728487`*^9, 
  3.773777885468885*^9}},ExpressionUUID->"3361d236-868b-4318-82da-\
54f6b0af1603"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"c1", "=", "4"}], ";", 
  RowBox[{"c2", "=", "3"}], ";", 
  RowBox[{"c3", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JA", "=", 
   RowBox[{
    RowBox[{"SparseArray", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Band", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], "}"}], "]"}], "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "c1"}], ",", "c3", ",", 
           RowBox[{"-", "c1"}], ",", "0", ",", "0"}], "}"}]}], ",", 
        RowBox[{
         RowBox[{"Band", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "3"}], "}"}], "]"}], "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"c3", ",", "c3", ",", 
           RowBox[{"2", "c3"}], ",", 
           RowBox[{"c1", "+", "c2"}]}], "}"}]}], ",", 
        RowBox[{
         RowBox[{"Band", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "4"}], "}"}], "]"}], "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"c3", ",", 
           RowBox[{"c1", "+", "c2"}], ",", 
           RowBox[{"c1", "+", "c2"}]}], "}"}]}], ",", 
        RowBox[{
         RowBox[{"Band", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "5"}], "}"}], "]"}], "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"c1", "+", "c2"}], ",", 
           RowBox[{
            RowBox[{"-", "2"}], "c3"}]}], "}"}]}], ",", 
        RowBox[{
         RowBox[{"Band", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "6"}], "}"}], "]"}], "\[Rule]", 
         RowBox[{
          RowBox[{"-", "2"}], "c3"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", "6"}], "}"}]}], "]"}], "//", "Normal"}]}], ";", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"JA", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
     RowBox[{"JA", "[", 
      RowBox[{"[", 
       RowBox[{"j", ",", "i"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "2", ",", "6"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "i"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JO", "=", 
   RowBox[{
    RowBox[{"SparseArray", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Band", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], "}"}], "]"}], "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "c1"}], ",", 
           RowBox[{"3", "c3"}], ",", 
           RowBox[{"-", "c1"}], ",", 
           RowBox[{
            RowBox[{"-", "2"}], "c3"}], ",", 
           RowBox[{"4", "c3"}]}], "}"}]}], ",", 
        RowBox[{
         RowBox[{"Band", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "3"}], "}"}], "]"}], "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"3", "c3"}], ",", 
           RowBox[{"2", "c3"}], ",", 
           RowBox[{
            RowBox[{"-", "2"}], "c3"}], ",", 
           RowBox[{"c1", "+", "c2"}]}], "}"}]}], ",", 
        RowBox[{
         RowBox[{"Band", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "4"}], "}"}], "]"}], "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"2", "c3"}], ",", 
           RowBox[{"c1", "+", "c2"}], ",", 
           RowBox[{"c1", "+", "c2"}]}], "}"}]}], ",", 
        RowBox[{
         RowBox[{"Band", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "5"}], "}"}], "]"}], "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"c1", "+", "c2"}], ",", 
           RowBox[{
            RowBox[{"-", "4"}], "c3"}]}], "}"}]}], ",", 
        RowBox[{
         RowBox[{"Band", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "6"}], "}"}], "]"}], "\[Rule]", 
         RowBox[{
          RowBox[{"-", "4"}], "c3"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", "6"}], "}"}]}], "]"}], "//", "Normal"}]}], ";", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"JO", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
     RowBox[{"JO", "[", 
      RowBox[{"[", 
       RowBox[{"j", ",", "i"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "2", ",", "6"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "i"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JX", "=", 
   RowBox[{
    RowBox[{"SparseArray", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Band", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], "}"}], "]"}], "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "c1"}], ",", 
           RowBox[{"3", "c3"}], ",", 
           RowBox[{"-", "c1"}], ",", 
           RowBox[{
            RowBox[{"-", "4"}], "c3"}], ",", 
           RowBox[{"8", "c3"}]}], "}"}]}], ",", 
        RowBox[{
         RowBox[{"Band", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "3"}], "}"}], "]"}], "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"3", "c3"}], ",", 
           RowBox[{"2", "c3"}], ",", 
           RowBox[{
            RowBox[{"-", "6"}], "c3"}], ",", 
           RowBox[{"c1", "+", "c2"}]}], "}"}]}], ",", 
        RowBox[{
         RowBox[{"Band", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "4"}], "}"}], "]"}], "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"2", "c3"}], ",", 
           RowBox[{"c1", "+", "c2"}], ",", 
           RowBox[{"c1", "+", "c2"}]}], "}"}]}], ",", 
        RowBox[{
         RowBox[{"Band", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "5"}], "}"}], "]"}], "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"c1", "+", "c2"}], ",", 
           RowBox[{
            RowBox[{"-", "4"}], "c3"}]}], "}"}]}], ",", 
        RowBox[{
         RowBox[{"Band", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "6"}], "}"}], "]"}], "\[Rule]", 
         RowBox[{
          RowBox[{"-", "4"}], "c3"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", "6"}], "}"}]}], "]"}], "//", "Normal"}]}], ";", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"JX", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
     RowBox[{"JX", "[", 
      RowBox[{"[", 
       RowBox[{"j", ",", "i"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "2", ",", "6"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "i"}], "}"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ha", "=", 
   RowBox[{"2", 
    RowBox[{"{", 
     RowBox[{"c2", ",", "c2", ",", "c2", ",", 
      RowBox[{"c2", "-", 
       RowBox[{"2", "c3"}]}], ",", 
      RowBox[{
       RowBox[{"-", "2"}], 
       RowBox[{"(", 
        RowBox[{"c3", "+", "c2"}], ")"}]}], ",", 
      RowBox[{
       RowBox[{"4", "c3"}], "-", 
       RowBox[{"2", "c2"}]}]}], "}"}]}]}], ";", 
  RowBox[{"ho", "=", 
   RowBox[{"2", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"c2", "-", "c3"}], ",", 
      RowBox[{"c2", "-", "c3"}], ",", "c2", ",", 
      RowBox[{"c2", "-", 
       RowBox[{"2", "c3"}]}], ",", 
      RowBox[{
       RowBox[{"-", "2"}], "c2"}], ",", 
      RowBox[{
       RowBox[{"4", "c3"}], "-", 
       RowBox[{"2", "c2"}]}]}], "}"}]}]}], ";", 
  RowBox[{"hx", "=", 
   RowBox[{"2", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"c2", "-", "c3"}], ",", 
      RowBox[{"c2", "-", "c3"}], ",", 
      RowBox[{"c2", "-", 
       RowBox[{"4", "c3"}]}], ",", 
      RowBox[{"c2", "-", 
       RowBox[{"4", "c3"}]}], ",", 
      RowBox[{"2", 
       RowBox[{"(", 
        RowBox[{"c3", "-", "c2"}], ")"}]}], ",", 
      RowBox[{"2", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"4", "c3"}], "-", "c2"}], ")"}]}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rtemp", "=", 
   RowBox[{"{", 
    RowBox[{"sx", ",", "sy", ",", "sz", ",", "sf", ",", "sa", ",", "sb"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CostA", "[", 
    RowBox[{
    "sx_", ",", "sy_", ",", "sz_", ",", "sf_", ",", "sa_", ",", "sb_"}], 
    "]"}], "=", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"-", "1"}], "8"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Rtemp", ".", "JA", ".", "Rtemp"}], "+", 
       RowBox[{"ha", ".", "Rtemp"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"1", "/", "2"}], 
     RowBox[{"(", 
      RowBox[{"c1", "+", 
       RowBox[{"2", "c2"}], "+", "c3"}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CostO", "[", 
    RowBox[{
    "sx_", ",", "sy_", ",", "sz_", ",", "sf_", ",", "sa_", ",", "sb_"}], 
    "]"}], "=", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"-", "1"}], "8"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Rtemp", ".", "JO", ".", "Rtemp"}], "+", 
       RowBox[{"ho", ".", "Rtemp"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"1", "/", "2"}], 
     RowBox[{"(", 
      RowBox[{"c1", "+", 
       RowBox[{"2", "c2"}], "+", "c3"}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CostX", "[", 
     RowBox[{
     "sx_", ",", "sy_", ",", "sz_", ",", "sf_", ",", "sa_", ",", "sb_"}], 
     "]"}], "=", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"-", "1"}], "8"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Rtemp", ".", "JX", ".", "Rtemp"}], "+", 
        RowBox[{"hx", ".", "Rtemp"}]}], ")"}]}], "+", 
     RowBox[{"c1", "/", "2"}], "+", "c2"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"(", "symbolic", ")"}], " ", "Spin", " ", "vector"}], ",", " ", 
    RowBox[{"basis", " ", "of", " ", "multiplier", " ", 
     RowBox[{"circuit", ".", " ", "This"}], " ", "is", " ", "used", " ", "to",
      " ", "define", " ", "the", " ", "full", " ", "J", " ", 
     RowBox[{"matrix", "."}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"spinvec", "[", "n_", "]"}], ":=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"Reverse", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"x", "[", "i", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}]}], "]"}], "]"}], ",", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"y", "[", "i", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}]}], "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"i", ",", "j"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "n"}], "}"}]}], "]"}], "//", "Flatten"}], ",", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"h", "[", 
          RowBox[{"i", ",", "j"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "2"}], "}"}]}], "]"}], "//", "Flatten"}], ",", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"i", ",", "j"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"n", 
            RowBox[{"(", 
             RowBox[{"n", "-", "2"}], ")"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "5"}], "}"}]}], "]"}], "//", "Flatten"}], ",", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"A", "[", 
          RowBox[{"i", ",", "j"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "n"}], "}"}]}], "]"}], "//", "Flatten"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"s", "[", "i", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"n", 
           RowBox[{"(", 
            RowBox[{"n", "-", "1"}], ")"}]}]}], "}"}]}], "]"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"c", "[", "i", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"n", 
           RowBox[{"(", 
            RowBox[{"n", "-", "1"}], ")"}]}]}], "}"}]}], "]"}], ",", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"\[Alpha]", "[", 
          RowBox[{"i", ",", "j"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "n"}], "}"}]}], "]"}], "//", "Flatten"}], ",", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"\[Beta]", "[", 
          RowBox[{"i", ",", "j"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "n"}], "}"}]}], "]"}], "//", "Flatten"}], ",", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"\[Mu]", "[", 
          RowBox[{"i", ",", "j"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "2"}], "}"}]}], "]"}], "//", "Flatten"}], ",", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"\[Nu]", "[", 
          RowBox[{"i", ",", "j"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "2"}], "}"}]}], "]"}], "//", "Flatten"}], ",", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"\[CurlyKappa]", "[", 
          RowBox[{"i", ",", "j"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"n", 
            RowBox[{"(", 
             RowBox[{"n", "-", "2"}], ")"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "5"}], "}"}]}], "]"}], "//", "Flatten"}], ",", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"\[Lambda]", "[", 
          RowBox[{"i", ",", "j"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"n", 
            RowBox[{"(", 
             RowBox[{"n", "-", "2"}], ")"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "5"}], "}"}]}], "]"}], "//", "Flatten"}], ",", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"\[CurlyTheta]", "[", 
          RowBox[{"i", ",", "j"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"n", 
            RowBox[{"(", 
             RowBox[{"n", "-", "2"}], ")"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "//", "Flatten"}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**"}],
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Everything", " ", "between", " ", "these", " ", "two", " ", "dividers", 
     " ", "is", " ", "used", " ", "to", " ", "build", " ", "the", " ", "cost",
      " ", "function", " ", "for", " ", "the", " ", "multiplier", " ", 
     "circuit"}], ",", " ", 
    RowBox[{
     RowBox[{"it", "'"}], "s", " ", "been", " ", "tested", " ", "everal", " ",
      "times", " ", "over", " ", "so", " ", 
     RowBox[{"I", "'"}], "m", " ", "positive", " ", 
     RowBox[{"it", "'"}], "s", " ", 
     RowBox[{"correct", "!"}]}]}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"halfadderpairs", "[", "n_", "]"}], ":=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"A", "[", 
            RowBox[{"1", ",", "i"}], "]"}], ",", 
           RowBox[{"A", "[", 
            RowBox[{"i", ",", "1"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"s", "[", 
            RowBox[{"i", "-", "1"}], "]"}], ",", 
           RowBox[{"c", "[", 
            RowBox[{"i", "-", "1"}], "]"}]}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", "n"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"c", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "1"}], ")"}], 
             RowBox[{"(", 
              RowBox[{"n", "-", "2"}], ")"}]}], "+", "1"}], "]"}], ",", 
          RowBox[{"s", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "1"}], ")"}], 
             RowBox[{"(", 
              RowBox[{"n", "-", "2"}], ")"}]}], "+", "2"}], "]"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"s", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "1"}], ")"}], "^", "2"}], "+", "1"}], "]"}], 
          ",", 
          RowBox[{"c", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "1"}], ")"}], "^", "2"}], "+", "1"}], "]"}]}],
          "}"}]}], "}"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"fatriplets", "[", "n_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     TagBox[GridBox[{
        {"\[Piecewise]", GridBox[{
           {
            TagBox[GridBox[{
               {"\[Piecewise]", GridBox[{
                  {
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"A", "[", 
                    RowBox[{"n", ",", 
                    RowBox[{"1", "+", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{"whichadder", ",", 
                    RowBox[{"n", "-", "1"}]}], "]"}]}]}], "]"}], ",", 
                    RowBox[{"A", "[", 
                    RowBox[{
                    RowBox[{"1", "+", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{"whichadder", ",", 
                    RowBox[{"n", "-", "1"}]}], "]"}]}], ",", "n"}], "]"}], 
                    ",", 
                    RowBox[{"c", "[", "whichadder", "]"}]}], "}"}], 
                   RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"whichadder", ",", 
                    RowBox[{"n", "-", "1"}]}], "]"}], "==", "0"}]},
                  {
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"A", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Quotient", "[", 
                    RowBox[{"whichadder", ",", 
                    RowBox[{"n", "-", "1"}]}], "]"}], "+", "2"}], ",", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"whichadder", ",", 
                    RowBox[{"n", "-", "1"}]}], "]"}], "+", "1"}]}], "]"}], 
                    ",", 
                    RowBox[{"s", "[", 
                    RowBox[{"whichadder", "+", "1"}], "]"}], ",", 
                    RowBox[{"c", "[", "whichadder", "]"}]}], "}"}], "True"}
                 },
                 AllowedDimensions->{2, Automatic},
                 Editable->True,
                 
                 GridBoxAlignment->{
                  "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
                   "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
                 
                 GridBoxItemSize->{
                  "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
                   "Rows" -> {{1.}}, "RowsIndexed" -> {}},
                 GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.84]}, 
                    Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                   "Rows" -> {
                    Offset[0.2], {
                    Offset[0.4]}, 
                    Offset[0.2]}, "RowsIndexed" -> {}},
                 Selectable->True]}
              },
              
              GridBoxAlignment->{
               "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
                "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
              
              GridBoxItemSize->{
               "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
                "Rows" -> {{1.}}, "RowsIndexed" -> {}},
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.27999999999999997`], {
                   Offset[0.35]}, 
                  Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                "Rows" -> {
                  Offset[0.2], {
                   Offset[0.4]}, 
                  Offset[0.2]}, "RowsIndexed" -> {}}],
             "Piecewise",
             DeleteWithContents->True,
             Editable->False,
             SelectWithContents->True,
             Selectable->False], 
            RowBox[{"whichadder", "\[LessEqual]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"n", "-", "1"}], ")"}], 
              RowBox[{"(", 
               RowBox[{"n", "-", "2"}], ")"}]}]}]},
           {
            TagBox[GridBox[{
               {"\[Piecewise]", GridBox[{
                  {
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"A", "[", 
                    RowBox[{"n", ",", "n"}], "]"}], ",", 
                    RowBox[{"c", "[", 
                    RowBox[{
                    RowBox[{"n", 
                    RowBox[{"(", 
                    RowBox[{"n", "-", "1"}], ")"}]}], "-", "1"}], "]"}], ",", 
                    
                    RowBox[{"c", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "-", "1"}], ")"}], "^", "2"}], "]"}]}], 
                    "}"}], 
                   RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"whichadder", ",", "n"}], "]"}], "\[Equal]", 
                    "0"}]},
                  {
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"c", "[", 
                    RowBox[{"whichadder", "+", "n", "-", "1"}], "]"}], ",", 
                    RowBox[{"s", "[", 
                    RowBox[{"whichadder", "+", "2"}], "]"}], ",", 
                    RowBox[{"c", "[", 
                    RowBox[{"whichadder", "+", "1"}], "]"}]}], "}"}], "True"}
                 },
                 AllowedDimensions->{2, Automatic},
                 Editable->True,
                 
                 GridBoxAlignment->{
                  "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
                   "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
                 
                 GridBoxItemSize->{
                  "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
                   "Rows" -> {{1.}}, "RowsIndexed" -> {}},
                 GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.84]}, 
                    Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                   "Rows" -> {
                    Offset[0.2], {
                    Offset[0.4]}, 
                    Offset[0.2]}, "RowsIndexed" -> {}},
                 Selectable->True]}
              },
              
              GridBoxAlignment->{
               "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
                "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
              
              GridBoxItemSize->{
               "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
                "Rows" -> {{1.}}, "RowsIndexed" -> {}},
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.27999999999999997`], {
                   Offset[0.35]}, 
                  Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                "Rows" -> {
                  Offset[0.2], {
                   Offset[0.4]}, 
                  Offset[0.2]}, "RowsIndexed" -> {}}],
             "Piecewise",
             DeleteWithContents->True,
             Editable->False,
             SelectWithContents->True,
             Selectable->False], 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"n", "-", "1"}], ")"}], 
              RowBox[{"(", 
               RowBox[{"n", "-", "2"}], ")"}]}], "<", "whichadder", 
             "\[LessEqual]", 
             RowBox[{
              SuperscriptBox["n", "2"], "-", 
              RowBox[{"2", "n"}]}]}]}
          },
          AllowedDimensions->{2, Automatic},
          Editable->True,
          GridBoxAlignment->{
           "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{1.}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.84]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}},
          Selectable->True]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxItemSize->{
        "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
         "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.35]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      "Piecewise",
      DeleteWithContents->True,
      Editable->False,
      SelectWithContents->True,
      Selectable->False], ",", 
     RowBox[{"{", 
      RowBox[{"whichadder", ",", 
       RowBox[{
        SuperscriptBox["n", "2"], "-", 
        RowBox[{"2", "n"}]}]}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"andcosts", "[", "n_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"CostA", "[", 
        RowBox[{
         RowBox[{"x", "[", "i", "]"}], ",", 
         RowBox[{"y", "[", "j", "]"}], ",", 
         RowBox[{"A", "[", 
          RowBox[{"i", ",", "j"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"i", ",", "j"}], "]"}], ",", 
         RowBox[{"\[Alpha]", "[", 
          RowBox[{"i", ",", "j"}], "]"}], ",", 
         RowBox[{"\[Beta]", "[", 
          RowBox[{"i", ",", "j"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], "//", "Flatten"}], 
    "//", "Total"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"halfaddercosts", "[", "n_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"CostA", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"halfadderpairs", "[", "n", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"halfadderpairs", "[", "n", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1", ",", "2"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"halfadderpairs", "[", "n", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2", ",", "2"}], "]"}], "]"}], ",", 
          RowBox[{"h", "[", 
           RowBox[{"i", ",", "1"}], "]"}], ",", 
          RowBox[{"\[Mu]", "[", 
           RowBox[{"i", ",", "1"}], "]"}], ",", 
          RowBox[{"\[Nu]", "[", 
           RowBox[{"i", ",", "1"}], "]"}]}], "]"}], "+", 
        RowBox[{"CostX", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"halfadderpairs", "[", "n", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"halfadderpairs", "[", "n", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1", ",", "2"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"halfadderpairs", "[", "n", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"h", "[", 
           RowBox[{"i", ",", "2"}], "]"}], ",", 
          RowBox[{"\[Mu]", "[", 
           RowBox[{"i", ",", "2"}], "]"}], ",", 
          RowBox[{"\[Nu]", "[", 
           RowBox[{"i", ",", "2"}], "]"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], "//", "Flatten"}], 
    "//", "Total"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fulladdercosts", "[", "n_", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"ft", "=", 
     RowBox[{"fatriplets", "[", "n", "]"}]}], ";", 
    RowBox[{
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"CostA", "[", 
          RowBox[{
           RowBox[{"ft", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"ft", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
           RowBox[{"\[CurlyTheta]", "[", 
            RowBox[{"i", ",", "1"}], "]"}], ",", 
           RowBox[{"f", "[", 
            RowBox[{"i", ",", "1"}], "]"}], ",", 
           RowBox[{"\[CurlyKappa]", "[", 
            RowBox[{"i", ",", "1"}], "]"}], ",", 
           RowBox[{"\[Lambda]", "[", 
            RowBox[{"i", ",", "1"}], "]"}]}], "]"}], "+", 
         RowBox[{"CostX", "[", 
          RowBox[{
           RowBox[{"ft", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"ft", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
           RowBox[{"\[CurlyTheta]", "[", 
            RowBox[{"i", ",", "2"}], "]"}], ",", 
           RowBox[{"f", "[", 
            RowBox[{"i", ",", "2"}], "]"}], ",", 
           RowBox[{"\[CurlyKappa]", "[", 
            RowBox[{"i", ",", "2"}], "]"}], ",", 
           RowBox[{"\[Lambda]", "[", 
            RowBox[{"i", ",", "2"}], "]"}]}], "]"}], "+", 
         RowBox[{"CostA", "[", 
          RowBox[{
           RowBox[{"\[CurlyTheta]", "[", 
            RowBox[{"i", ",", "2"}], "]"}], ",", 
           RowBox[{"ft", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "3"}], "]"}], "]"}], ",", 
           RowBox[{"\[CurlyTheta]", "[", 
            RowBox[{"i", ",", "3"}], "]"}], ",", 
           RowBox[{"f", "[", 
            RowBox[{"i", ",", "3"}], "]"}], ",", 
           RowBox[{"\[CurlyKappa]", "[", 
            RowBox[{"i", ",", "3"}], "]"}], ",", 
           RowBox[{"\[Lambda]", "[", 
            RowBox[{"i", ",", "3"}], "]"}]}], "]"}], "+", 
         RowBox[{"CostX", "[", 
          RowBox[{
           RowBox[{"\[CurlyTheta]", "[", 
            RowBox[{"i", ",", "2"}], "]"}], ",", 
           RowBox[{"ft", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "3"}], "]"}], "]"}], ",", 
           RowBox[{"s", "[", 
            RowBox[{"i", "+", "n", "+", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"i", "\[LessEqual]", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"n", "-", "1"}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{"n", "-", "2"}], ")"}]}]}], ",", 
               RowBox[{"-", "1"}], ",", "0"}], "]"}]}], "]"}], ",", 
           RowBox[{"f", "[", 
            RowBox[{"i", ",", "4"}], "]"}], ",", 
           RowBox[{"\[CurlyKappa]", "[", 
            RowBox[{"i", ",", "4"}], "]"}], ",", 
           RowBox[{"\[Lambda]", "[", 
            RowBox[{"i", ",", "4"}], "]"}]}], "]"}], "+", 
         RowBox[{"CostO", "[", 
          RowBox[{
           RowBox[{"\[CurlyTheta]", "[", 
            RowBox[{"i", ",", "1"}], "]"}], ",", 
           RowBox[{"\[CurlyTheta]", "[", 
            RowBox[{"i", ",", "3"}], "]"}], ",", 
           RowBox[{"c", "[", 
            RowBox[{"i", "+", "n", "+", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"i", "\[LessEqual]", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"n", "-", "1"}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{"n", "-", "2"}], ")"}]}]}], ",", 
               RowBox[{"-", "1"}], ",", "0"}], "]"}]}], "]"}], ",", 
           RowBox[{"f", "[", 
            RowBox[{"i", ",", "5"}], "]"}], ",", 
           RowBox[{"\[CurlyKappa]", "[", 
            RowBox[{"i", ",", "5"}], "]"}], ",", 
           RowBox[{"\[Lambda]", "[", 
            RowBox[{"i", ",", "5"}], "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{
           SuperscriptBox["n", "2"], "-", 
           RowBox[{"2", "n"}]}]}], "}"}]}], "]"}], "//", "Flatten"}], "//", 
     "Total"}]}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"const", "[", "n_", "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"CoefficientArrays", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"andcosts", "[", "n", "]"}], "+", 
        RowBox[{"halfaddercosts", "[", "n", "]"}], "+", 
        RowBox[{"fulladdercosts", "[", "n", "]"}]}], ",", 
       RowBox[{"spinvec", "[", "n", "]"}]}], "]"}], ")"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hm", "[", "n_", "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"CoefficientArrays", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"andcosts", "[", "n", "]"}], "+", 
        RowBox[{"halfaddercosts", "[", "n", "]"}], "+", 
        RowBox[{"fulladdercosts", "[", "n", "]"}]}], ",", 
       RowBox[{"spinvec", "[", "n", "]"}]}], "]"}], ")"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Jm", "[", "n_", "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"CoefficientArrays", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"andcosts", "[", "n", "]"}], "+", 
        RowBox[{"halfaddercosts", "[", "n", "]"}], "+", 
        RowBox[{"fulladdercosts", "[", "n", "]"}]}], ",", 
       RowBox[{"spinvec", "[", "n", "]"}]}], "]"}], ")"}], "[", 
    RowBox[{"[", "3", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ZS", "[", "n_", "]"}], ":=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c", "[", 
       RowBox[{"n", 
        RowBox[{"(", 
         RowBox[{"n", "-", "1"}], ")"}]}], "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"s", "[", 
       RowBox[{"n", 
        RowBox[{"(", 
         RowBox[{"n", "-", "1"}], ")"}]}], "]"}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"s", "[", 
        RowBox[{
         RowBox[{"n", 
          RowBox[{"(", 
           RowBox[{"n", "-", "1"}], ")"}]}], "-", "i"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"n", "-", "2"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"s", "[", 
        RowBox[{
         RowBox[{"n", 
          RowBox[{"(", 
           RowBox[{"n", "-", "1"}], ")"}]}], "-", "n", "+", "2", "-", 
         RowBox[{"i", 
          RowBox[{"(", 
           RowBox[{"n", "-", "1"}], ")"}]}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"A", "[", 
       RowBox[{"1", ",", "1"}], "]"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"HammingPositions", "[", "n_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{
        RowBox[{"spinvec", "[", "n", "]"}], ",", 
        RowBox[{
         RowBox[{"ZS", "[", "n", "]"}], "[", 
         RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"2", "n"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{"Gate", " ", "operations", " ", "for", " ", "spins"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"and", ":=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"sxx_", ",", "syy_"}], "}"}], "\[Rule]", 
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"sxx", " ", "syy"}], "+", "sxx", " ", "+", "syy", "-", "1"}], 
      ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xor", ":=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"sxx_", ",", "syy_"}], "}"}], "\[Rule]", 
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{"sxx", " ", "syy"}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"or", ":=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"sxx_", ",", "syy_"}], "}"}], "\[Rule]", 
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "sxx"}], " ", "syy"}], "+", "sxx", " ", "+", "syy", "+", 
       "1"}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"idmap", ":=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"nm_", ",", "kl_"}], "}"}], "\[Rule]", "1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gates", "=", 
   RowBox[{"{", 
    RowBox[{"and", ",", "xor", ",", "and", ",", "xor", ",", "or"}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Define", "[", "num_", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"n", "=", "num"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"smalls", "=", 
     RowBox[{"spinvec", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"acost", "=", 
     RowBox[{"andcosts", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"hacosts", "=", 
     RowBox[{"halfaddercosts", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
    
    RowBox[{"facosts", "=", 
     RowBox[{"fulladdercosts", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
    
    RowBox[{"array", "=", 
     RowBox[{"CoefficientArrays", "[", 
      RowBox[{
       RowBox[{"acost", "+", "hacosts", "+", "facosts"}], ",", "smalls"}], 
      "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"co", "=", 
     RowBox[{"array", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"H", "=", 
     RowBox[{"array", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"J", "=", 
     RowBox[{"array", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"ov", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"c", "[", 
         RowBox[{"n", 
          RowBox[{"(", 
           RowBox[{"n", "-", "1"}], ")"}]}], "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"s", "[", 
         RowBox[{"n", 
          RowBox[{"(", 
           RowBox[{"n", "-", "1"}], ")"}]}], "]"}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"s", "[", 
          RowBox[{
           RowBox[{"n", 
            RowBox[{"(", 
             RowBox[{"n", "-", "1"}], ")"}]}], "-", "i"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"n", "-", "2"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"s", "[", 
          RowBox[{
           RowBox[{"n", 
            RowBox[{"(", 
             RowBox[{"n", "-", "1"}], ")"}]}], "-", "n", "+", "2", "-", 
           RowBox[{"i", 
            RowBox[{"(", 
             RowBox[{"n", "-", "1"}], ")"}]}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"A", "[", 
         RowBox[{"1", ",", "1"}], "]"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Hpos", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"smalls", ",", 
          RowBox[{"ov", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"2", "n"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"FaultPositions", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"2", "num"}], "+", "1"}], ",", 
         RowBox[{"6", "num", 
          RowBox[{"(", 
           RowBox[{"num", "-", "1"}], ")"}]}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"SpinPositions", "=", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"i", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{"6", "num", 
             RowBox[{"(", 
              RowBox[{"num", "-", "1"}], ")"}]}], "+", "1"}], ",", 
           RowBox[{"6", "num", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", "num"}], "-", "5"}], ")"}]}]}], "}"}]}], "]"}], 
       ",", 
       RowBox[{
        RowBox[{"\[Not]", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"Hpos", ",", "#"}], "]"}]}], "&"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"afpos", ",", "hfpos", ",", "ffpos"}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FaultPositions", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", 
          SuperscriptBox["n", "2"]}], "]"}], "]"}], ",", 
       RowBox[{"FaultPositions", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"1", "+", 
           SuperscriptBox["n", "2"]}], ";;", 
          RowBox[{
           SuperscriptBox["n", "2"], "+", 
           RowBox[{"2", "n"}]}]}], "]"}], "]"}], ",", 
       RowBox[{"FaultPositions", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           SuperscriptBox["n", "2"], "+", 
           RowBox[{"2", "n"}], "+", "1"}], ";;", 
          RowBox[{
           RowBox[{"6", 
            SuperscriptBox["n", "2"]}], "-", 
           RowBox[{"8", "n"}]}]}], "]"}], "]"}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"apos", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"6", 
           SuperscriptBox["n", "2"]}], "-", 
          RowBox[{"6", "n"}], "+", "1"}], ",", 
         RowBox[{
          RowBox[{"7", 
           SuperscriptBox["n", "2"]}], "-", 
          RowBox[{"6", "n"}]}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"alphapos", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"9", 
           SuperscriptBox["n", "2"]}], "-", 
          RowBox[{"8", "n"}], "+", "1"}], ",", 
         RowBox[{
          RowBox[{"10", 
           SuperscriptBox["n", "2"]}], "-", 
          RowBox[{"8", "n"}]}]}], "}"}]}], "]"}]}], ";", 
    RowBox[{"betapos", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"10", 
           SuperscriptBox["n", "2"]}], "-", 
          RowBox[{"8", "n"}], "+", "1"}], ",", 
         RowBox[{
          RowBox[{"11", 
           SuperscriptBox["n", "2"]}], "-", 
          RowBox[{"8", "n"}]}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"spos", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"7", 
           SuperscriptBox["n", "2"]}], "-", 
          RowBox[{"6", "n"}], "+", "1"}], ",", 
         RowBox[{
          RowBox[{"8", 
           SuperscriptBox["n", "2"]}], "-", 
          RowBox[{"7", "n"}]}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"stoprow", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"7", 
           SuperscriptBox["n", "2"]}], "-", 
          RowBox[{"6", "n"}], "+", "1"}], ",", 
         RowBox[{
          RowBox[{"7", 
           SuperscriptBox["n", "2"]}], "-", 
          RowBox[{"6", "n"}], "+", "n", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"cpos", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"8", 
           SuperscriptBox["n", "2"]}], "-", 
          RowBox[{"7", "n"}], "+", "1"}], ",", 
         RowBox[{
          RowBox[{"9", 
           SuperscriptBox["n", "2"]}], "-", 
          RowBox[{"8", "n"}]}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"ctoprow", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"8", 
           SuperscriptBox["n", "2"]}], "-", 
          RowBox[{"7", "n"}], "+", "1"}], ",", 
         RowBox[{
          RowBox[{"8", 
           SuperscriptBox["n", "2"]}], "-", 
          RowBox[{"7", "n"}], "+", "n", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"mupos", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"11", 
           SuperscriptBox["n", "2"]}], "-", 
          RowBox[{"8", "n"}], "+", "1"}], ",", 
         RowBox[{
          RowBox[{"11", 
           SuperscriptBox["n", "2"]}], "-", 
          RowBox[{"6", "n"}]}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"nupos", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"11", 
           SuperscriptBox["n", "2"]}], "-", 
          RowBox[{"6", "n"}], "+", "1"}], ",", 
         RowBox[{
          RowBox[{"11", 
           SuperscriptBox["n", "2"]}], "-", 
          RowBox[{"4", "n"}]}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"chipos", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"11", 
           SuperscriptBox["n", "2"]}], "-", 
          RowBox[{"4", "n"}], "+", "1"}], ",", 
         RowBox[{
          RowBox[{"16", 
           SuperscriptBox["n", "2"]}], "-", 
          RowBox[{"14", "n"}]}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"lambdapos", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"16", 
           SuperscriptBox["n", "2"]}], "-", 
          RowBox[{"14", "n"}], "+", "1"}], ",", 
         RowBox[{
          RowBox[{"21", 
           SuperscriptBox["n", "2"]}], "-", 
          RowBox[{"24", "n"}]}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", " ", 
    RowBox[{"vthetapos", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"21", 
           SuperscriptBox["n", "2"]}], "-", 
          RowBox[{"24", "n"}], "+", "1"}], ",", 
         RowBox[{
          RowBox[{"21", 
           SuperscriptBox["n", "2"]}], "-", 
          RowBox[{"24", "n"}], "+", 
          RowBox[{"3", "n", 
           RowBox[{"(", 
            RowBox[{"n", "-", "2"}], ")"}]}]}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"spinweights", "=", 
     RowBox[{"{", "}"}]}], ";", "\n", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"coeff", "=", 
        RowBox[{"2", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"J", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "+", 
           RowBox[{
            RowBox[{"J", "\[Transpose]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"posit", "=", 
        RowBox[{"Sort", "[", 
         RowBox[{
          RowBox[{"coeff", "[", "\"\<NonzeroPositions\>\"", "]"}], "//", 
          "Flatten"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"weight", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"posit", ",", 
             RowBox[{"Select", "[", 
              RowBox[{"coeff", ",", 
               RowBox[{
                RowBox[{"#", "\[NotEqual]", "0"}], "&"}]}], "]"}]}], "}"}], 
           "\[Transpose]"}], ",", 
          RowBox[{"{", 
           RowBox[{"2", 
            RowBox[{"H", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"spinweights", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "weight"}], "}"}]}], "]"}], ";"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"6", "num", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", "num"}], "-", "5"}], ")"}]}]}], "}"}]}], "]"}], ";", 
    "\n", 
    RowBox[{"spinweights2", "=", 
     RowBox[{"{", "}"}]}], ";", "\n", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"coeff", "=", 
        RowBox[{"2", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"J", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "+", 
           RowBox[{
            RowBox[{"J", "\[Transpose]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"posit", "=", 
        RowBox[{"Sort", "[", 
         RowBox[{
          RowBox[{"coeff", "[", "\"\<NonzeroPositions\>\"", "]"}], "//", 
          "Flatten"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"weight", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"posit", ",", 
             RowBox[{"Select", "[", 
              RowBox[{"coeff", ",", 
               RowBox[{
                RowBox[{"#", "\[NotEqual]", "0"}], "&"}]}], "]"}]}], "}"}], 
           "\[Transpose]"}], ",", 
          RowBox[{"{", 
           RowBox[{"2", 
            RowBox[{"H", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"spinweights2", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"2", 
            RowBox[{"H", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"posit", ",", 
              RowBox[{"Select", "[", 
               RowBox[{"coeff", ",", 
                RowBox[{
                 RowBox[{"#", "\[NotEqual]", "0"}], "&"}]}], "]"}]}], "}"}], 
            "\[Transpose]"}]}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
      ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"6", "num", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", "num"}], "-", "5"}], ")"}]}]}], "}"}]}], "]"}], ";", 
    "\n", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"afpos", ",", "hfpos", ",", "ffpos"}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FaultPositions", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", 
          SuperscriptBox["num", "2"]}], "]"}], "]"}], ",", 
       RowBox[{"FaultPositions", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"1", "+", 
           SuperscriptBox["num", "2"]}], ";;", 
          RowBox[{
           SuperscriptBox["num", "2"], "+", 
           RowBox[{"2", "num"}]}]}], "]"}], "]"}], ",", 
       RowBox[{"FaultPositions", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           SuperscriptBox["num", "2"], "+", 
           RowBox[{"2", "num"}], "+", "1"}], ";;", 
          RowBox[{
           RowBox[{"6", 
            SuperscriptBox["num", "2"]}], "-", 
           RowBox[{"8", "num"}]}]}], "]"}], "]"}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"apos", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"6", 
           SuperscriptBox["num", "2"]}], "-", 
          RowBox[{"6", "num"}], "+", "1"}], ",", 
         RowBox[{
          RowBox[{"7", 
           SuperscriptBox["num", "2"]}], "-", 
          RowBox[{"6", "num"}]}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"alphapos", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"9", 
           SuperscriptBox["num", "2"]}], "-", 
          RowBox[{"8", "num"}], "+", "1"}], ",", 
         RowBox[{
          RowBox[{"10", 
           SuperscriptBox["num", "2"]}], "-", 
          RowBox[{"8", "num"}]}]}], "}"}]}], "]"}]}], ";", 
    RowBox[{"betapos", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"10", 
           SuperscriptBox["num", "2"]}], "-", 
          RowBox[{"8", "num"}], "+", "1"}], ",", 
         RowBox[{
          RowBox[{"11", 
           SuperscriptBox["num", "2"]}], "-", 
          RowBox[{"8", "num"}]}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"spos", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"7", 
           SuperscriptBox["num", "2"]}], "-", 
          RowBox[{"6", "num"}], "+", "1"}], ",", 
         RowBox[{
          RowBox[{"8", 
           SuperscriptBox["num", "2"]}], "-", 
          RowBox[{"7", "num"}]}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"stoprow", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"7", 
           SuperscriptBox["num", "2"]}], "-", 
          RowBox[{"6", "num"}], "+", "1"}], ",", 
         RowBox[{
          RowBox[{"7", 
           SuperscriptBox["num", "2"]}], "-", 
          RowBox[{"6", "num"}], "+", "num", "-", "1"}]}], "}"}]}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"cpos", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"8", 
           SuperscriptBox["num", "2"]}], "-", 
          RowBox[{"7", "num"}], "+", "1"}], ",", 
         RowBox[{
          RowBox[{"9", 
           SuperscriptBox["num", "2"]}], "-", 
          RowBox[{"8", "num"}]}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"ctoprow", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"8", 
           SuperscriptBox["num", "2"]}], "-", 
          RowBox[{"7", "num"}], "+", "1"}], ",", 
         RowBox[{
          RowBox[{"8", 
           SuperscriptBox["num", "2"]}], "-", 
          RowBox[{"7", "num"}], "+", "num", "-", "1"}]}], "}"}]}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"mupos", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"11", 
           SuperscriptBox["num", "2"]}], "-", 
          RowBox[{"8", "num"}], "+", "1"}], ",", 
         RowBox[{
          RowBox[{"11", 
           SuperscriptBox["num", "2"]}], "-", 
          RowBox[{"6", "num"}]}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"nupos", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"11", 
           SuperscriptBox["num", "2"]}], "-", 
          RowBox[{"6", "num"}], "+", "1"}], ",", 
         RowBox[{
          RowBox[{"11", 
           SuperscriptBox["num", "2"]}], "-", 
          RowBox[{"4", "num"}]}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"chipos", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"11", 
           SuperscriptBox["num", "2"]}], "-", 
          RowBox[{"4", "num"}], "+", "1"}], ",", 
         RowBox[{
          RowBox[{"16", 
           SuperscriptBox["num", "2"]}], "-", 
          RowBox[{"14", "num"}]}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"lambdapos", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"16", 
           SuperscriptBox["num", "2"]}], "-", 
          RowBox[{"14", "num"}], "+", "1"}], ",", 
         RowBox[{
          RowBox[{"21", 
           SuperscriptBox["num", "2"]}], "-", 
          RowBox[{"24", "num"}]}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"vthetapos", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"21", 
           SuperscriptBox["num", "2"]}], "-", 
          RowBox[{"24", "num"}], "+", "1"}], ",", 
         RowBox[{
          RowBox[{"21", 
           SuperscriptBox["num", "2"]}], "-", 
          RowBox[{"24", "num"}], "+", 
          RowBox[{"3", "num", 
           RowBox[{"(", 
            RowBox[{"num", "-", "2"}], ")"}]}]}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"lf", "=", 
     RowBox[{"Length", "[", "FaultPositions", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"la", "=", 
     RowBox[{"Length", "[", "SpinPositions", "]"}]}], ";", 
    RowBox[{"allf", "=", 
     RowBox[{"Range", "[", 
      RowBox[{"1", ",", "lf"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"RandomSP", "=", 
     RowBox[{"RandomSample", "[", "SpinPositions", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"RandomFP", "=", 
     RowBox[{"RandomSample", "[", "FaultPositions", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"joint", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"FaultPositions", ",", "SpinPositions"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FnGlobal", "[", 
   RowBox[{"dimensions_", ",", "faultnum_"}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n", "=", "dimensions"}], ";", 
    RowBox[{"S", "=", 
     RowBox[{"spinvec", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Hpos", "=", 
     RowBox[{"HammingPositions", "[", "n", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"FaultPositions", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"2", "n"}], "+", "1"}], ",", 
         RowBox[{"6", "n", 
          RowBox[{"(", 
           RowBox[{"n", "-", "1"}], ")"}]}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"activefault", "=", 
     RowBox[{"RandomSample", "[", 
      RowBox[{"FaultPositions", ",", "faultnum"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"SpinPositions", "=", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"i", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{"6", "n", 
             RowBox[{"(", 
              RowBox[{"n", "-", "1"}], ")"}]}], "+", "1"}], ",", 
           RowBox[{"6", "n", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", "n"}], "-", "5"}], ")"}]}]}], "}"}]}], "]"}], ",", 
       
       RowBox[{
        RowBox[{"\[Not]", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"Hpos", ",", "#"}], "]"}]}], "&"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"afpos", ",", "hfpos", ",", "ffpos"}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FaultPositions", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", 
          SuperscriptBox["n", "2"]}], "]"}], "]"}], ",", 
       RowBox[{"FaultPositions", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"1", "+", 
           SuperscriptBox["n", "2"]}], ";;", 
          RowBox[{
           SuperscriptBox["n", "2"], "+", 
           RowBox[{"2", "n"}]}]}], "]"}], "]"}], ",", 
       RowBox[{"FaultPositions", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           SuperscriptBox["n", "2"], "+", 
           RowBox[{"2", "n"}], "+", "1"}], ";;", 
          RowBox[{
           RowBox[{"6", 
            SuperscriptBox["n", "2"]}], "-", 
           RowBox[{"8", "n"}]}]}], "]"}], "]"}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"apos", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"6", 
           SuperscriptBox["n", "2"]}], "-", 
          RowBox[{"6", "n"}], "+", "1"}], ",", 
         RowBox[{
          RowBox[{"7", 
           SuperscriptBox["n", "2"]}], "-", 
          RowBox[{"6", "n"}]}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"alphapos", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"9", 
           SuperscriptBox["n", "2"]}], "-", 
          RowBox[{"8", "n"}], "+", "1"}], ",", 
         RowBox[{
          RowBox[{"10", 
           SuperscriptBox["n", "2"]}], "-", 
          RowBox[{"8", "n"}]}]}], "}"}]}], "]"}]}], ";", 
    RowBox[{"betapos", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"10", 
           SuperscriptBox["n", "2"]}], "-", 
          RowBox[{"8", "n"}], "+", "1"}], ",", 
         RowBox[{
          RowBox[{"11", 
           SuperscriptBox["n", "2"]}], "-", 
          RowBox[{"8", "n"}]}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"spos", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"7", 
           SuperscriptBox["n", "2"]}], "-", 
          RowBox[{"6", "n"}], "+", "1"}], ",", 
         RowBox[{
          RowBox[{"8", 
           SuperscriptBox["n", "2"]}], "-", 
          RowBox[{"7", "n"}]}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"stoprow", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"7", 
           SuperscriptBox["n", "2"]}], "-", 
          RowBox[{"6", "n"}], "+", "1"}], ",", 
         RowBox[{
          RowBox[{"7", 
           SuperscriptBox["n", "2"]}], "-", 
          RowBox[{"6", "n"}], "+", "n", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"cpos", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"8", 
           SuperscriptBox["n", "2"]}], "-", 
          RowBox[{"7", "n"}], "+", "1"}], ",", 
         RowBox[{
          RowBox[{"9", 
           SuperscriptBox["n", "2"]}], "-", 
          RowBox[{"8", "n"}]}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"ctoprow", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"8", 
           SuperscriptBox["n", "2"]}], "-", 
          RowBox[{"7", "n"}], "+", "1"}], ",", 
         RowBox[{
          RowBox[{"8", 
           SuperscriptBox["n", "2"]}], "-", 
          RowBox[{"7", "n"}], "+", "n", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"mupos", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"11", 
           SuperscriptBox["n", "2"]}], "-", 
          RowBox[{"8", "n"}], "+", "1"}], ",", 
         RowBox[{
          RowBox[{"11", 
           SuperscriptBox["n", "2"]}], "-", 
          RowBox[{"6", "n"}]}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"nupos", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"11", 
           SuperscriptBox["n", "2"]}], "-", 
          RowBox[{"6", "n"}], "+", "1"}], ",", 
         RowBox[{
          RowBox[{"11", 
           SuperscriptBox["n", "2"]}], "-", 
          RowBox[{"4", "n"}]}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"chipos", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"11", 
           SuperscriptBox["n", "2"]}], "-", 
          RowBox[{"4", "n"}], "+", "1"}], ",", 
         RowBox[{
          RowBox[{"16", 
           SuperscriptBox["n", "2"]}], "-", 
          RowBox[{"14", "n"}]}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"lambdapos", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"16", 
           SuperscriptBox["n", "2"]}], "-", 
          RowBox[{"14", "n"}], "+", "1"}], ",", 
         RowBox[{
          RowBox[{"21", 
           SuperscriptBox["n", "2"]}], "-", 
          RowBox[{"24", "n"}]}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", " ", 
    RowBox[{"vthetapos", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"21", 
           SuperscriptBox["n", "2"]}], "-", 
          RowBox[{"24", "n"}], "+", "1"}], ",", 
         RowBox[{
          RowBox[{"21", 
           SuperscriptBox["n", "2"]}], "-", 
          RowBox[{"24", "n"}], "+", 
          RowBox[{"3", "n", 
           RowBox[{"(", 
            RowBox[{"n", "-", "2"}], ")"}]}]}]}], "}"}]}], "]"}]}], ";"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Propagate", "[", 
     RowBox[{"invec1_", ",", "invec2_"}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Sym", "=", 
       RowBox[{"RandomChoice", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", 
           RowBox[{"-", "1"}]}], "}"}], ",", 
         RowBox[{"6", "n", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", "n"}], "-", "5"}], ")"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Sym", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "n"}], "]"}], "]"}], "=", "invec1"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Sym", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"n", "+", "1"}], ";;", 
          RowBox[{"2", "n"}]}], "]"}], "]"}], "=", "invec2"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Sym", "[", 
        RowBox[{"[", "FaultPositions", "]"}], "]"}], "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "FaultPositions", "]"}]}], "}"}]}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Sym", "[", 
        RowBox[{"[", "activefault", "]"}], "]"}], "=", 
       RowBox[{"Table", "[", 
        RowBox[{"1", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "activefault", "]"}]}], "}"}]}], "]"}]}], 
      ";", "\n", 
      RowBox[{"AndFaults", "=", 
       RowBox[{"Sym", "[", 
        RowBox[{"[", 
         RowBox[{"FaultPositions", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", 
            SuperscriptBox["n", "2"]}], "]"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AndInputs", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Sym", "[", 
              RowBox[{"[", 
               RowBox[{"n", "-", "j", "+", "1"}], "]"}], "]"}], ",", 
             RowBox[{"Sym", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"2", "n"}], "-", "k", "+", "1"}], "]"}], "]"}]}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "n"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", "1"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Sym", "[", 
        RowBox[{"[", "apos", "]"}], "]"}], "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"AndInputs", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "/.", "and"}], ")"}], 
           FractionBox[
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"AndFaults", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], ")"}], "2"]}], "+", 
          FractionBox[
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"AndFaults", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], ")"}], "2"]}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           SuperscriptBox["n", "2"]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Sym", "[", 
        RowBox[{"[", "alphapos", "]"}], "]"}], "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"AndInputs", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "/.", "and"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           SuperscriptBox["n", "2"]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Sym", "[", 
        RowBox[{"[", "betapos", "]"}], "]"}], "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"AndFaults", "[", 
             RowBox[{"[", "j", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"Sym", "[", 
              RowBox[{"[", "apos", "]"}], "]"}], "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], "}"}], "/.", "and"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           SuperscriptBox["n", "2"]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"HAInputsTR", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Sym", "[", 
          RowBox[{"[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"i", "+", 
              RowBox[{"6", 
               SuperscriptBox["n", "2"]}], "-", 
              RowBox[{"6", "n"}]}], ",", 
             RowBox[{"i", "+", 
              RowBox[{"6", 
               SuperscriptBox["n", "2"]}], "-", 
              RowBox[{"6", "n"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"i", "-", "1"}], ")"}], 
               RowBox[{"(", 
                RowBox[{"n", "-", "1"}], ")"}]}]}]}], "}"}], "]"}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", "n"}], "}"}]}], "]"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"Sym", "[", 
        RowBox[{"[", 
         RowBox[{"mupos", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", 
            RowBox[{"-", "3"}]}], "]"}], "]"}], "]"}], "]"}], "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"HAInputsTR", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "/.", "and"}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ",", "1"}], "]"}]}], 
      ";", "\n", 
      RowBox[{
       RowBox[{"Sym", "[", 
        RowBox[{"[", "stoprow", "]"}], "]"}], "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"HAInputsTR", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "/.", "xor"}], ")"}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"Sym", "[", 
               RowBox[{"[", 
                RowBox[{"hfpos", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", "+", 
                   RowBox[{"2", 
                    RowBox[{"(", 
                    RowBox[{"k", "-", "1"}], ")"}]}]}], "]"}], "]"}], "]"}], 
               "]"}]}], ")"}], "/", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"Sym", "[", 
              RowBox[{"[", 
               RowBox[{"hfpos", "[", 
                RowBox[{"[", 
                 RowBox[{"2", "+", 
                  RowBox[{"2", 
                   RowBox[{"(", 
                    RowBox[{"k", "-", "1"}], ")"}]}]}], "]"}], "]"}], "]"}], 
              "]"}]}], ")"}], "/", "2"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Sym", "[", 
        RowBox[{"[", "ctoprow", "]"}], "]"}], "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"HAInputsTR", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "/.", "and"}], ")"}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"Sym", "[", 
               RowBox[{"[", 
                RowBox[{"hfpos", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", "+", 
                   RowBox[{"2", 
                    RowBox[{"(", 
                    RowBox[{"k", "-", "1"}], ")"}]}]}], "]"}], "]"}], "]"}], 
               "]"}]}], ")"}], "/", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"Sym", "[", 
              RowBox[{"[", 
               RowBox[{"hfpos", "[", 
                RowBox[{"[", 
                 RowBox[{"1", "+", 
                  RowBox[{"2", 
                   RowBox[{"(", 
                    RowBox[{"k", "-", "1"}], ")"}]}]}], "]"}], "]"}], "]"}], 
              "]"}]}], ")"}], "/", "2"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"toprowouts", "=", 
       RowBox[{
        RowBox[{"Riffle", "[", 
         RowBox[{
          RowBox[{"Sym", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{
              RowBox[{"8", 
               SuperscriptBox["n", "2"]}], "-", 
              RowBox[{"7", "n"}], "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"8", 
               SuperscriptBox["n", "2"]}], "-", 
              RowBox[{"7", "n"}], "+", 
              RowBox[{"2", "n"}]}]}], "]"}], "]"}], ",", 
          RowBox[{"Sym", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{
              RowBox[{"7", 
               SuperscriptBox["n", "2"]}], "-", 
              RowBox[{"6", "n"}], "+", "1"}], ";;", 
             RowBox[{
              RowBox[{"8", 
               SuperscriptBox["n", "2"]}], "-", 
              RowBox[{"7", "n"}]}]}], "]"}], "]"}]}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", 
          RowBox[{
           RowBox[{"2", "n"}], "-", "2"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Sym", "[", 
        RowBox[{"[", 
         RowBox[{"nupos", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", 
            RowBox[{"-", "3"}]}], "]"}], "]"}], "]"}], "]"}], "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Sym", "[", 
             RowBox[{"[", 
              RowBox[{"hfpos", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"toprowouts", "[", 
             RowBox[{"[", "k", "]"}], "]"}]}], "}"}], "/.", "and"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"2", 
            RowBox[{"(", 
             RowBox[{"n", "-", "1"}], ")"}]}]}], "}"}]}], "]"}]}], ";", "\n", 
      
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"gate", "\[LessEqual]", "3"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"gate", "\[LessEqual]", "2"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"Sym", "[", 
                  RowBox[{"[", 
                   RowBox[{"vthetapos", "[", 
                    RowBox[{"[", 
                    RowBox[{"gate", "+", 
                    RowBox[{"3", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}]}], "]"}], "]"}], 
                   "]"}], "]"}], "=", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"adder", ",", 
                    RowBox[{"n", "-", "1"}]}], "]"}], "\[Equal]", "0"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"apos", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"n", "-", "1"}], ")"}]}], "+", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{"adder", ",", 
                    RowBox[{"n", "-", "1"}], ",", "1"}], "]"}]}], "]"}], 
                    "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"spos", "[", 
                    RowBox[{"[", 
                    RowBox[{"adder", "+", "1"}], "]"}], "]"}], "]"}], "]"}]}],
                     "]"}], ",", 
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"apos", "[", 
                    RowBox[{"[", 
                    RowBox[{"adder", "+", "n", "+", "1", "+", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{"adder", ",", 
                    RowBox[{"n", "-", "1"}], ",", "1"}], "]"}]}], "]"}], 
                    "]"}], "]"}], "]"}]}], "}"}], "/.", 
                    RowBox[{"gates", "[", 
                    RowBox[{"[", "gate", "]"}], "]"}]}], ")"}], 
                   RowBox[{
                    FractionBox["1", "2"], 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"ffpos", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"5", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}], "+", "gate"}], 
                    "]"}], "]"}], "]"}], "]"}]}], ")"}]}]}], "+", 
                  RowBox[{
                   FractionBox["1", "2"], 
                   RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"ffpos", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"5", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}], "+", "gate"}], 
                    "]"}], "]"}], "]"}], "]"}]}], ")"}]}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Sym", "[", 
                  RowBox[{"[", 
                   RowBox[{"chipos", "[", 
                    RowBox[{"[", 
                    RowBox[{"gate", "+", 
                    RowBox[{"5", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}]}], "]"}], "]"}], 
                   "]"}], "]"}], "=", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"adder", ",", 
                    RowBox[{"n", "-", "1"}]}], "]"}], "\[Equal]", "0"}], ",", 
                    
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"apos", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"n", "-", "1"}], ")"}]}], "+", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{"adder", ",", 
                    RowBox[{"n", "-", "1"}], ",", "1"}], "]"}]}], "]"}], 
                    "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"spos", "[", 
                    RowBox[{"[", 
                    RowBox[{"adder", "+", "1"}], "]"}], "]"}], "]"}], "]"}]}],
                     "]"}], ",", 
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"apos", "[", 
                    RowBox[{"[", 
                    RowBox[{"adder", "+", "n", "+", "1", "+", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{"adder", ",", 
                    RowBox[{"n", "-", "1"}], ",", "1"}], "]"}]}], "]"}], 
                    "]"}], "]"}], "]"}]}], "}"}], "/.", "and"}], ")"}]}], ";",
                 "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Sym", "[", 
                  RowBox[{"[", 
                   RowBox[{"lambdapos", "[", 
                    RowBox[{"[", 
                    RowBox[{"gate", "+", 
                    RowBox[{"5", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}]}], "]"}], "]"}], 
                   "]"}], "]"}], "=", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"vthetapos", "[", 
                    RowBox[{"[", 
                    RowBox[{"gate", "+", 
                    RowBox[{"3", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}]}], "]"}], "]"}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"ffpos", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"5", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}], "+", "gate"}], 
                    "]"}], "]"}], "]"}], "]"}]}], "}"}], "/.", "and"}], 
                  ")"}]}], ";"}], "\[IndentingNewLine]", ",", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"Sym", "[", 
                  RowBox[{"[", 
                   RowBox[{"vthetapos", "[", 
                    RowBox[{"[", 
                    RowBox[{"gate", "+", 
                    RowBox[{"3", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}]}], "]"}], "]"}], 
                   "]"}], "]"}], "=", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"cpos", "[", 
                    RowBox[{"[", "adder", "]"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"vthetapos", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"3", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}], "+", "gate", "-", 
                    "1"}], "]"}], "]"}], "]"}], "]"}]}], "}"}], "/.", 
                    RowBox[{"gates", "[", 
                    RowBox[{"[", "gate", "]"}], "]"}]}], ")"}], 
                   RowBox[{
                    FractionBox["1", "2"], 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"ffpos", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"5", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}], "+", "gate"}], 
                    "]"}], "]"}], "]"}], "]"}]}], ")"}]}]}], "+", 
                  RowBox[{
                   FractionBox["1", "2"], 
                   RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"ffpos", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"5", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}], "+", "gate"}], 
                    "]"}], "]"}], "]"}], "]"}]}], ")"}]}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Sym", "[", 
                  RowBox[{"[", 
                   RowBox[{"chipos", "[", 
                    RowBox[{"[", 
                    RowBox[{"gate", "+", 
                    RowBox[{"5", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}]}], "]"}], "]"}], 
                   "]"}], "]"}], "=", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"cpos", "[", 
                    RowBox[{"[", "adder", "]"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"vthetapos", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"3", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}], "+", "gate", "-", 
                    "1"}], "]"}], "]"}], "]"}], "]"}]}], "}"}], "/.", "and"}],
                   ")"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Sym", "[", 
                  RowBox[{"[", 
                   RowBox[{"lambdapos", "[", 
                    RowBox[{"[", 
                    RowBox[{"gate", "+", 
                    RowBox[{"5", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}]}], "]"}], "]"}], 
                   "]"}], "]"}], "=", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"vthetapos", "[", 
                    RowBox[{"[", 
                    RowBox[{"gate", "+", 
                    RowBox[{"3", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}]}], "]"}], "]"}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"ffpos", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"5", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}], "+", "gate"}], 
                    "]"}], "]"}], "]"}], "]"}]}], "}"}], "/.", "and"}]}], 
                ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"gate", "\[Equal]", "4"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"Sym", "[", 
                 RowBox[{"[", 
                  RowBox[{"spos", "[", 
                   RowBox[{"[", 
                    RowBox[{"adder", "+", "n", "-", "1"}], "]"}], "]"}], 
                  "]"}], "]"}], "=", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"cpos", "[", 
                    RowBox[{"[", "adder", "]"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"vthetapos", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"3", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}], "+", "gate", "-", 
                    "2"}], "]"}], "]"}], "]"}], "]"}]}], "}"}], "/.", "xor"}],
                    ")"}], 
                  RowBox[{
                   FractionBox["1", "2"], 
                   RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"ffpos", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"5", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}], "+", "gate"}], 
                    "]"}], "]"}], "]"}], "]"}]}], ")"}]}]}], "+", 
                 RowBox[{
                  FractionBox["1", "2"], 
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"ffpos", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"5", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}], "+", "gate"}], 
                    "]"}], "]"}], "]"}], "]"}]}], ")"}]}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Sym", "[", 
                 RowBox[{"[", 
                  RowBox[{"chipos", "[", 
                   RowBox[{"[", 
                    RowBox[{"gate", "+", 
                    RowBox[{"5", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}]}], "]"}], "]"}], 
                  "]"}], "]"}], "=", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"cpos", "[", 
                    RowBox[{"[", "adder", "]"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"vthetapos", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"3", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}], "+", "gate", "-", 
                    "2"}], "]"}], "]"}], "]"}], "]"}]}], "}"}], "/.", "and"}],
                  ")"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Sym", "[", 
                 RowBox[{"[", 
                  RowBox[{"lambdapos", "[", 
                   RowBox[{"[", 
                    RowBox[{"gate", "+", 
                    RowBox[{"5", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}]}], "]"}], "]"}], 
                  "]"}], "]"}], "=", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"spos", "[", 
                    RowBox[{"[", 
                    RowBox[{"adder", "+", "n", "-", "1"}], "]"}], "]"}], 
                    "]"}], "]"}], ",", 
                   RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"ffpos", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"5", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}], "+", "gate"}], 
                    "]"}], "]"}], "]"}], "]"}]}], "}"}], "/.", "and"}]}], 
               ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"Sym", "[", 
                 RowBox[{"[", 
                  RowBox[{"cpos", "[", 
                   RowBox[{"[", 
                    RowBox[{"adder", "+", "n", "-", "1"}], "]"}], "]"}], 
                  "]"}], "]"}], "=", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"vthetapos", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"3", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}], "+", "1"}], "]"}], 
                    "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"vthetapos", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"3", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}], "+", "gate", "-", 
                    "2"}], "]"}], "]"}], "]"}], "]"}]}], "}"}], "/.", "or"}], 
                   ")"}], 
                  RowBox[{
                   FractionBox["1", "2"], 
                   RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"ffpos", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"5", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}], "+", "gate"}], 
                    "]"}], "]"}], "]"}], "]"}]}], ")"}]}]}], "+", 
                 RowBox[{
                  FractionBox["1", "2"], 
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"ffpos", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"5", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}], "+", "gate"}], 
                    "]"}], "]"}], "]"}], "]"}]}], ")"}]}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Sym", "[", 
                 RowBox[{"[", 
                  RowBox[{"chipos", "[", 
                   RowBox[{"[", 
                    RowBox[{"gate", "+", 
                    RowBox[{"5", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}]}], "]"}], "]"}], 
                  "]"}], "]"}], "=", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"vthetapos", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"3", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}], "+", "gate", "-", 
                    "4"}], "]"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"vthetapos", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"3", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}], "+", "gate", "-", 
                    "2"}], "]"}], "]"}], "]"}], "]"}]}], "}"}], "/.", "and"}],
                  ")"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Sym", "[", 
                 RowBox[{"[", 
                  RowBox[{"lambdapos", "[", 
                   RowBox[{"[", 
                    RowBox[{"gate", "+", 
                    RowBox[{"5", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}]}], "]"}], "]"}], 
                  "]"}], "]"}], "=", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"cpos", "[", 
                    RowBox[{"[", 
                    RowBox[{"adder", "+", "n", "-", "1"}], "]"}], "]"}], 
                    "]"}], "]"}], ",", 
                   RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"ffpos", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"5", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}], "+", "gate"}], 
                    "]"}], "]"}], "]"}], "]"}]}], "}"}], "/.", "and"}]}], 
               ";"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]",
            "]"}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"gate", ",", "5"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
        ",", 
        RowBox[{"{", 
         RowBox[{"adder", ",", "1", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "-", "1"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"n", "-", "2"}], ")"}]}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Bottom", " ", "Row", " ", "Starts", " ", "Here"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Half", " ", "Adder"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Sym", "[", 
        RowBox[{"[", 
         RowBox[{"spos", "[", 
          RowBox[{"[", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"n", "-", "1"}], ")"}], "2"], "+", "1"}], "]"}], "]"}], 
         "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Sym", "[", 
              RowBox[{"[", 
               RowBox[{"cpos", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"n", "-", "1"}], ")"}], 
                   RowBox[{"(", 
                    RowBox[{"n", "-", "2"}], ")"}]}], "+", "1"}], "]"}], 
                "]"}], "]"}], "]"}], ",", 
             RowBox[{"Sym", "[", 
              RowBox[{"[", 
               RowBox[{"spos", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"n", "-", "1"}], ")"}], 
                   RowBox[{"(", 
                    RowBox[{"n", "-", "2"}], ")"}]}], "+", "2"}], "]"}], 
                "]"}], "]"}], "]"}]}], "}"}], "/.", "xor"}], ")"}], 
         FractionBox[
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"Sym", "[", 
             RowBox[{"[", 
              RowBox[{"hfpos", "[", 
               RowBox[{"[", 
                RowBox[{"2", "n"}], "]"}], "]"}], "]"}], "]"}]}], ")"}], 
          "2"]}], "+", 
        FractionBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"Sym", "[", 
            RowBox[{"[", 
             RowBox[{"hfpos", "[", 
              RowBox[{"[", 
               RowBox[{"2", "n"}], "]"}], "]"}], "]"}], "]"}]}], ")"}], 
         "2"]}]}], ";", "\n", 
      RowBox[{
       RowBox[{"Sym", "[", 
        RowBox[{"[", 
         RowBox[{"cpos", "[", 
          RowBox[{"[", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"n", "-", "1"}], ")"}], "2"], "+", "1"}], "]"}], "]"}], 
         "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Sym", "[", 
              RowBox[{"[", 
               RowBox[{"cpos", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"n", "-", "1"}], ")"}], 
                   RowBox[{"(", 
                    RowBox[{"n", "-", "2"}], ")"}]}], "+", "1"}], "]"}], 
                "]"}], "]"}], "]"}], ",", 
             RowBox[{"Sym", "[", 
              RowBox[{"[", 
               RowBox[{"spos", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"n", "-", "1"}], ")"}], 
                   RowBox[{"(", 
                    RowBox[{"n", "-", "2"}], ")"}]}], "+", "2"}], "]"}], 
                "]"}], "]"}], "]"}]}], "}"}], "/.", "and"}], ")"}], 
         FractionBox[
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"Sym", "[", 
             RowBox[{"[", 
              RowBox[{"hfpos", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"2", "n"}], "-", "1"}], "]"}], "]"}], "]"}], "]"}]}],
            ")"}], "2"]}], "+", 
        FractionBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"Sym", "[", 
            RowBox[{"[", 
             RowBox[{"hfpos", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"2", "n"}], "-", "1"}], "]"}], "]"}], "]"}], "]"}]}], 
          ")"}], "2"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Sym", "[", 
        RowBox[{"[", 
         RowBox[{"mupos", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"2", "n"}], "-", "1"}], "]"}], "]"}], "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Sym", "[", 
           RowBox[{"[", 
            RowBox[{"spos", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"n", "-", "1"}], ")"}], 
                RowBox[{"(", 
                 RowBox[{"n", "-", "2"}], ")"}]}], "+", "2"}], "]"}], "]"}], 
            "]"}], "]"}], ",", 
          RowBox[{"Sym", "[", 
           RowBox[{"[", 
            RowBox[{"cpos", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"n", "-", "1"}], ")"}], 
                RowBox[{"(", 
                 RowBox[{"n", "-", "2"}], ")"}]}], "+", "1"}], "]"}], "]"}], 
            "]"}], "]"}]}], "}"}], "/.", "and"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Sym", "[", 
        RowBox[{"[", 
         RowBox[{"mupos", "[", 
          RowBox[{"[", 
           RowBox[{"2", "n"}], "]"}], "]"}], "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Sym", "[", 
           RowBox[{"[", 
            RowBox[{"spos", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"n", "-", "1"}], ")"}], 
                RowBox[{"(", 
                 RowBox[{"n", "-", "2"}], ")"}]}], "+", "2"}], "]"}], "]"}], 
            "]"}], "]"}], ",", 
          RowBox[{"Sym", "[", 
           RowBox[{"[", 
            RowBox[{"cpos", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"n", "-", "1"}], ")"}], 
                RowBox[{"(", 
                 RowBox[{"n", "-", "2"}], ")"}]}], "+", "1"}], "]"}], "]"}], 
            "]"}], "]"}]}], "}"}], "/.", "and"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Sym", "[", 
        RowBox[{"[", 
         RowBox[{"nupos", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"2", "n"}], "-", "1"}], "]"}], "]"}], "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Sym", "[", 
           RowBox[{"[", 
            RowBox[{"cpos", "[", 
             RowBox[{"[", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"n", "-", "1"}], ")"}], "2"], "+", "1"}], "]"}], 
             "]"}], "]"}], "]"}], ",", 
          RowBox[{"Sym", "[", 
           RowBox[{"[", 
            RowBox[{"hfpos", "[", 
             RowBox[{"[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", "n"}], "-", "1"}], ")"}], "]"}], "]"}], "]"}], 
           "]"}]}], "}"}], "/.", "and"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Sym", "[", 
        RowBox[{"[", 
         RowBox[{"nupos", "[", 
          RowBox[{"[", 
           RowBox[{"2", "n"}], "]"}], "]"}], "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Sym", "[", 
           RowBox[{"[", 
            RowBox[{"spos", "[", 
             RowBox[{"[", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"n", "-", "1"}], ")"}], "2"], "+", "1"}], "]"}], 
             "]"}], "]"}], "]"}], ",", 
          RowBox[{"Sym", "[", 
           RowBox[{"[", 
            RowBox[{"hfpos", "[", 
             RowBox[{"[", 
              RowBox[{"(", 
               RowBox[{"2", "n"}], ")"}], "]"}], "]"}], "]"}], "]"}]}], "}"}],
         "/.", "and"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Bottom", " ", "Row", " ", "Full", " ", "Adders"}], "*)"}], 
      "\n", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"gate", "\[LessEqual]", "3"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"gate", "\[LessEqual]", "2"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"vthetapos", "[", 
                    RowBox[{"[", 
                    RowBox[{"gate", "+", 
                    RowBox[{"3", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}]}], "]"}], "]"}], 
                    "]"}], "]"}], "=", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"spos", "[", 
                    RowBox[{"[", 
                    RowBox[{"adder", "+", "2"}], "]"}], "]"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"cpos", "[", 
                    RowBox[{"[", 
                    RowBox[{"adder", "+", "n", "-", "1"}], "]"}], "]"}], 
                    "]"}], "]"}]}], "}"}], "/.", 
                    RowBox[{"gates", "[", 
                    RowBox[{"[", "gate", "]"}], "]"}]}], ")"}], 
                    RowBox[{
                    FractionBox["1", "2"], 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"ffpos", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"5", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}], "+", "gate"}], 
                    "]"}], "]"}], "]"}], "]"}]}], ")"}]}]}], "+", 
                    RowBox[{
                    FractionBox["1", "2"], 
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"ffpos", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"5", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}], "+", "gate"}], 
                    "]"}], "]"}], "]"}], "]"}]}], ")"}]}]}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"chipos", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"5", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}], "+", "gate"}], 
                    "]"}], "]"}], "]"}], "]"}], "=", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"spos", "[", 
                    RowBox[{"[", 
                    RowBox[{"adder", "+", "2"}], "]"}], "]"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"cpos", "[", 
                    RowBox[{"[", 
                    RowBox[{"adder", "+", "n", "-", "1"}], "]"}], "]"}], 
                    "]"}], "]"}]}], "}"}], "/.", "and"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"lambdapos", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"5", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}], "+", "gate"}], 
                    "]"}], "]"}], "]"}], "]"}], "=", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"vthetapos", "[", 
                    RowBox[{"[", 
                    RowBox[{"gate", "+", 
                    RowBox[{"3", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}]}], "]"}], "]"}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"ffpos", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"5", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}], "+", "gate"}], 
                    "]"}], "]"}], "]"}], "]"}]}], "}"}], "/.", "and"}]}], 
                  ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"vthetapos", "[", 
                    RowBox[{"[", 
                    RowBox[{"gate", "+", 
                    RowBox[{"3", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}]}], "]"}], "]"}], 
                    "]"}], "]"}], "=", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"cpos", "[", 
                    RowBox[{"[", 
                    RowBox[{"adder", "+", "1"}], "]"}], "]"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"vthetapos", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", "+", 
                    RowBox[{"3", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}]}], "]"}], "]"}], 
                    "]"}], "]"}]}], "}"}], "/.", 
                    RowBox[{"gates", "[", 
                    RowBox[{"[", "gate", "]"}], "]"}]}], ")"}], 
                    RowBox[{
                    FractionBox["1", "2"], 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"(", 
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"ffpos", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"5", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}], "+", "gate"}], 
                    "]"}], "]"}], "]"}], "]"}], ")"}]}], ")"}]}]}], "+", 
                    RowBox[{
                    FractionBox["1", "2"], 
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"(", 
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"ffpos", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"5", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}], "+", "gate"}], 
                    "]"}], "]"}], "]"}], "]"}], ")"}]}], ")"}]}]}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"chipos", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"5", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}], "+", "gate"}], 
                    "]"}], "]"}], "]"}], "]"}], "=", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"cpos", "[", 
                    RowBox[{"[", 
                    RowBox[{"adder", "+", "1"}], "]"}], "]"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"vthetapos", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", "+", 
                    RowBox[{"3", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}]}], "]"}], "]"}], 
                    "]"}], "]"}]}], "}"}], "/.", "and"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"lambdapos", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"5", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}], "+", "gate"}], 
                    "]"}], "]"}], "]"}], "]"}], "=", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"vthetapos", "[", 
                    RowBox[{"[", 
                    RowBox[{"gate", "+", 
                    RowBox[{"3", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}]}], "]"}], "]"}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"ffpos", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"5", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}], "+", "gate"}], 
                    "]"}], "]"}], "]"}], "]"}]}], "}"}], "/.", "and"}]}], 
                  ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"gate", "\[Equal]", "5"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"Sym", "[", 
                 RowBox[{"[", 
                  RowBox[{"cpos", "[", 
                   RowBox[{"[", 
                    RowBox[{"adder", "+", "n"}], "]"}], "]"}], "]"}], "]"}], 
                "=", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"vthetapos", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", "+", 
                    RowBox[{"3", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}]}], "]"}], "]"}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"vthetapos", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", "+", 
                    RowBox[{"3", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}]}], "]"}], "]"}], 
                    "]"}], "]"}]}], "}"}], "/.", 
                    RowBox[{"gates", "[", 
                    RowBox[{"[", "gate", "]"}], "]"}]}], ")"}], 
                  RowBox[{
                   FractionBox["1", "2"], 
                   RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"ffpos", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"5", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}], "+", "gate"}], 
                    "]"}], "]"}], "]"}], "]"}]}], ")"}]}]}], "+", 
                 RowBox[{
                  FractionBox["1", "2"], 
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"ffpos", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"5", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}], "+", "gate"}], 
                    "]"}], "]"}], "]"}], "]"}]}], ")"}]}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Sym", "[", 
                 RowBox[{"[", 
                  RowBox[{"chipos", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"5", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}], "+", "gate"}], 
                    "]"}], "]"}], "]"}], "]"}], "=", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"vthetapos", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", "+", 
                    RowBox[{"3", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}]}], "]"}], "]"}], 
                    "]"}], "]"}], ",", 
                   RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"vthetapos", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", "+", 
                    RowBox[{"3", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}]}], "]"}], "]"}], 
                    "]"}], "]"}]}], "}"}], "/.", "and"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Sym", "[", 
                 RowBox[{"[", 
                  RowBox[{"lambdapos", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"5", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}], "+", "gate"}], 
                    "]"}], "]"}], "]"}], "]"}], "=", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"cpos", "[", 
                    RowBox[{"[", 
                    RowBox[{"adder", "+", "n"}], "]"}], "]"}], "]"}], "]"}], 
                   ",", 
                   RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"ffpos", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"5", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}], "+", "gate"}], 
                    "]"}], "]"}], "]"}], "]"}]}], "}"}], "/.", "and"}]}], 
               ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
           "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"gate", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2", ",", "3", ",", "5"}], "}"}]}], "}"}]}], 
          "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"adder", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{"n", "-", "2"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"n", 
            RowBox[{"(", 
             RowBox[{"n", "-", "2"}], ")"}]}], "-", "1"}]}], "}"}]}], "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Sym", "[", 
           RowBox[{"[", 
            RowBox[{"spos", "[", 
             RowBox[{"[", 
              RowBox[{"adder", "+", "n"}], "]"}], "]"}], "]"}], "]"}], "=", 
          " ", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Sym", "[", 
                 RowBox[{"[", 
                  RowBox[{"cpos", "[", 
                   RowBox[{"[", 
                    RowBox[{"adder", "+", "1"}], "]"}], "]"}], "]"}], "]"}], 
                ",", 
                RowBox[{"Sym", "[", 
                 RowBox[{"[", 
                  RowBox[{"vthetapos", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", "+", 
                    RowBox[{"3", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}]}], "]"}], "]"}], 
                  "]"}], "]"}]}], "}"}], "/.", 
              RowBox[{"gates", "[", 
               RowBox[{"[", "4", "]"}], "]"}]}], ")"}], 
            RowBox[{
             FractionBox["1", "2"], 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"(", 
                RowBox[{"Sym", "[", 
                 RowBox[{"[", 
                  RowBox[{"ffpos", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"5", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}], "+", "4"}], "]"}], 
                   "]"}], "]"}], "]"}], ")"}]}], ")"}]}]}], "+", 
           RowBox[{
            FractionBox["1", "2"], 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"(", 
               RowBox[{"Sym", "[", 
                RowBox[{"[", 
                 RowBox[{"ffpos", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"5", 
                    RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}], "+", "4"}], "]"}], 
                  "]"}], "]"}], "]"}], ")"}]}], ")"}]}]}]}], ";"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"adder", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{"n", "-", "2"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"n", 
            RowBox[{"(", 
             RowBox[{"n", "-", "2"}], ")"}]}], "-", "1"}]}], "}"}]}], "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Aux", " ", "Outputs", " ", "from", " ", "all", " ", "FAs", " ", 
        "before", " ", "last", " ", "FOURTH", " ", "GATE", " ", "ONLY"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Sym", "[", 
           RowBox[{"[", 
            RowBox[{"chipos", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"5", 
                RowBox[{"(", 
                 RowBox[{"adder", "-", "1"}], ")"}]}], "+", "4"}], "]"}], 
             "]"}], "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Sym", "[", 
              RowBox[{"[", 
               RowBox[{"cpos", "[", 
                RowBox[{"[", 
                 RowBox[{"adder", "+", "1"}], "]"}], "]"}], "]"}], "]"}], ",", 
             RowBox[{"Sym", "[", 
              RowBox[{"[", 
               RowBox[{"vthetapos", "[", 
                RowBox[{"[", 
                 RowBox[{"2", "+", 
                  RowBox[{"3", 
                   RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}]}], "]"}], "]"}], 
               "]"}], "]"}]}], "}"}], "/.", "and"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Sym", "[", 
           RowBox[{"[", 
            RowBox[{"lambdapos", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"5", 
                RowBox[{"(", 
                 RowBox[{"adder", "-", "1"}], ")"}]}], "+", "4"}], "]"}], 
             "]"}], "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Sym", "[", 
              RowBox[{"[", 
               RowBox[{"spos", "[", 
                RowBox[{"[", 
                 RowBox[{"adder", "+", "n"}], "]"}], "]"}], "]"}], "]"}], ",", 
             RowBox[{"Sym", "[", 
              RowBox[{"[", 
               RowBox[{"ffpos", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"5", 
                   RowBox[{"(", 
                    RowBox[{"adder", "-", "1"}], ")"}]}], "+", "4"}], "]"}], 
                "]"}], "]"}], "]"}]}], "}"}], "/.", "and"}]}], ";"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"adder", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{"n", "-", "2"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"n", 
            RowBox[{"(", 
             RowBox[{"n", "-", "2"}], ")"}]}], "-", "1"}]}], "}"}]}], "]"}], 
      ";", "\n", 
      RowBox[{"(*", 
       RowBox[{"Outputs", " ", "from", " ", "last", " ", "FA"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"gate", "\[LessEqual]", "3"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"gate", "\[LessEqual]", "2"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Sym", "[", 
               RowBox[{"[", 
                RowBox[{"vthetapos", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"-", "4"}], "+", "gate"}], "]"}], "]"}], "]"}], 
               "]"}], "=", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"cpos", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"n", "-", "1"}], ")"}], "2"], "+", "n", "-", 
                    "2"}], "]"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"apos", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "]"}], "]"}]}], "}"}], "/.", 
                  RowBox[{"gates", "[", 
                   RowBox[{"[", "gate", "]"}], "]"}]}], ")"}], 
                RowBox[{
                 FractionBox["1", "2"], 
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"ffpos", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "6"}], "+", "gate"}], "]"}], "]"}], "]"}], 
                    "]"}]}], ")"}]}]}], "+", 
               FractionBox[
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"Sym", "[", 
                   RowBox[{"[", 
                    RowBox[{"ffpos", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "6"}], "+", "gate"}], "]"}], "]"}], "]"}], 
                   "]"}]}], ")"}], "2"]}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Sym", "[", 
               RowBox[{"[", 
                RowBox[{"chipos", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"-", "6"}], "+", "gate"}], "]"}], "]"}], "]"}], 
               "]"}], "=", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Sym", "[", 
                  RowBox[{"[", 
                   RowBox[{"cpos", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"n", "-", "1"}], ")"}], "2"], "+", "n", "-", 
                    "2"}], "]"}], "]"}], "]"}], "]"}], ",", 
                 RowBox[{"Sym", "[", 
                  RowBox[{"[", 
                   RowBox[{"apos", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "]"}], "]"}]}], "}"}], "/.",
                "and"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Sym", "[", 
               RowBox[{"[", 
                RowBox[{"lambdapos", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"-", "6"}], "+", "gate"}], "]"}], "]"}], "]"}], 
               "]"}], "=", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Sym", "[", 
                  RowBox[{"[", 
                   RowBox[{"vthetapos", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "4"}], "+", "gate"}], "]"}], "]"}], "]"}], 
                  "]"}], ",", 
                 RowBox[{"Sym", "[", 
                  RowBox[{"[", 
                   RowBox[{"ffpos", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "6"}], "+", "gate"}], "]"}], "]"}], "]"}], 
                  "]"}]}], "}"}], "/.", "and"}]}], ";"}], 
            "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Sym", "[", 
               RowBox[{"[", 
                RowBox[{"vthetapos", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"-", "4"}], "+", "gate"}], "]"}], "]"}], "]"}], 
               "]"}], "=", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"cpos", "[", 
                    RowBox[{"[", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"n", "-", "1"}], ")"}], "2"], "]"}], "]"}], "]"}],
                     "]"}], ",", 
                    RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"vthetapos", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "4"}], "+", "gate", "-", "1"}], "]"}], "]"}],
                     "]"}], "]"}]}], "}"}], "/.", 
                  RowBox[{"gates", "[", 
                   RowBox[{"[", "gate", "]"}], "]"}]}], ")"}], 
                RowBox[{
                 FractionBox["1", "2"], 
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"Sym", "[", 
                    RowBox[{"[", 
                    RowBox[{"ffpos", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "6"}], "+", "gate"}], "]"}], "]"}], "]"}], 
                    "]"}]}], ")"}]}]}], "+", 
               FractionBox[
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"Sym", "[", 
                   RowBox[{"[", 
                    RowBox[{"ffpos", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "6"}], "+", "gate"}], "]"}], "]"}], "]"}], 
                   "]"}]}], ")"}], "2"]}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Sym", "[", 
               RowBox[{"[", 
                RowBox[{"chipos", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"-", "6"}], "+", "gate"}], "]"}], "]"}], "]"}], 
               "]"}], "=", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Sym", "[", 
                  RowBox[{"[", 
                   RowBox[{"cpos", "[", 
                    RowBox[{"[", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"n", "-", "1"}], ")"}], "2"], "]"}], "]"}], "]"}],
                   "]"}], ",", 
                 RowBox[{"Sym", "[", 
                  RowBox[{"[", 
                   RowBox[{"vthetapos", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "4"}], "+", "gate", "-", "1"}], "]"}], "]"}],
                    "]"}], "]"}]}], "}"}], "/.", "and"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Sym", "[", 
               RowBox[{"[", 
                RowBox[{"lambdapos", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"-", "6"}], "+", "gate"}], "]"}], "]"}], "]"}], 
               "]"}], "=", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Sym", "[", 
                  RowBox[{"[", 
                   RowBox[{"vthetapos", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "4"}], "+", "gate"}], "]"}], "]"}], "]"}], 
                  "]"}], ",", 
                 RowBox[{"Sym", "[", 
                  RowBox[{"[", 
                   RowBox[{"ffpos", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "6"}], "+", "gate"}], "]"}], "]"}], "]"}], 
                  "]"}]}], "}"}], "/.", "and"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"gate", ",", "1", ",", "3"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"gate", "\[Equal]", "4"}], ",", 
          RowBox[{
           RowBox[{"Sym", "[", 
            RowBox[{"[", 
             RowBox[{"spos", "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}], "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Sym", "[", 
                  RowBox[{"[", 
                   RowBox[{"cpos", "[", 
                    RowBox[{"[", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"n", "-", "1"}], ")"}], "2"], "]"}], "]"}], "]"}],
                   "]"}], ",", 
                 RowBox[{"Sym", "[", 
                  RowBox[{"[", 
                   RowBox[{"vthetapos", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "2"}], "]"}], "]"}], "]"}], "]"}]}], "}"}], "/.", 
               RowBox[{"gates", "[", 
                RowBox[{"[", "gate", "]"}], "]"}]}], ")"}], 
             FractionBox[
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"Sym", "[", 
                 RowBox[{"[", 
                  RowBox[{"ffpos", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "6"}], "+", "gate"}], "]"}], "]"}], "]"}], 
                 "]"}]}], ")"}], "2"]}], "+", 
            FractionBox[
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"Sym", "[", 
                RowBox[{"[", 
                 RowBox[{"ffpos", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"-", "6"}], "+", "gate"}], "]"}], "]"}], "]"}], 
                "]"}]}], ")"}], "2"]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Sym", "[", 
            RowBox[{"[", 
             RowBox[{"cpos", "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}], "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Sym", "[", 
                  RowBox[{"[", 
                   RowBox[{"vthetapos", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "]"}], "]"}], ",", 
                 RowBox[{"Sym", "[", 
                  RowBox[{"[", 
                   RowBox[{"vthetapos", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "3"}], "]"}], "]"}], "]"}], "]"}]}], "}"}], "/.", 
               RowBox[{"gates", "[", 
                RowBox[{"[", "gate", "]"}], "]"}]}], ")"}], 
             FractionBox[
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"Sym", "[", 
                 RowBox[{"[", 
                  RowBox[{"ffpos", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "6"}], "+", "gate"}], "]"}], "]"}], "]"}], 
                 "]"}]}], ")"}], "2"]}], "+", 
            FractionBox[
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"Sym", "[", 
                RowBox[{"[", 
                 RowBox[{"ffpos", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"-", "6"}], "+", "gate"}], "]"}], "]"}], "]"}], 
                "]"}]}], ")"}], "2"]}]}]}], "\[IndentingNewLine]", "]"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"gate", ",", "4", ",", "5"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Aux", " ", "outputs", " ", "from", " ", "last", " ", "two", " ", 
        "gates"}], "*)"}], 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Sym", "[", 
           RowBox[{"[", 
            RowBox[{"chipos", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"-", "6"}], "+", "gate"}], "]"}], "]"}], "]"}], "]"}], 
          "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"gate", "\[Equal]", "4"}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Sym", "[", 
                RowBox[{"[", 
                 RowBox[{"cpos", "[", 
                  RowBox[{"[", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"n", "-", "1"}], ")"}], "2"], "]"}], "]"}], "]"}],
                 "]"}], ",", 
               RowBox[{"Sym", "[", 
                RowBox[{"[", 
                 RowBox[{"vthetapos", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "2"}], "]"}], "]"}], "]"}], "]"}]}], "}"}], "/.",
              "and"}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Sym", "[", 
                RowBox[{"[", 
                 RowBox[{"vthetapos", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "3"}], "]"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"Sym", "[", 
                RowBox[{"[", 
                 RowBox[{"vthetapos", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}], "]"}], "]"}]}], "}"}], "/.",
              "and"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Sym", "[", 
           RowBox[{"[", 
            RowBox[{"lambdapos", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"-", "6"}], "+", "gate"}], "]"}], "]"}], "]"}], "]"}], 
          "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"gate", "\[Equal]", "4"}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Sym", "[", 
                RowBox[{"[", 
                 RowBox[{"spos", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"Sym", "[", 
                RowBox[{"[", 
                 RowBox[{"ffpos", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "2"}], "]"}], "]"}], "]"}], "]"}]}], "}"}], "/.",
              "and"}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Sym", "[", 
                RowBox[{"[", 
                 RowBox[{"cpos", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"Sym", "[", 
                RowBox[{"[", 
                 RowBox[{"ffpos", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}], "]"}], "]"}]}], "}"}], "/.",
              "and"}]}], "]"}]}]}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"gate", ",", "4", ",", "5"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Sym", "[", 
        RowBox[{"[", "Hpos", "]"}], "]"}], "=", 
       RowBox[{"Reverse", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Sym", "[", 
            RowBox[{"[", 
             RowBox[{"apos", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "}"}], ",", 
          RowBox[{"Sym", "[", 
           RowBox[{"[", 
            RowBox[{"spos", "[", 
             RowBox[{"[", 
              RowBox[{"1", ";;", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"n", "-", "1"}], ")"}], "2"], ";;", 
               RowBox[{"n", "-", "1"}]}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{"Sym", "[", 
           RowBox[{"[", 
            RowBox[{"spos", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"n", "-", "1"}], ")"}], "2"], "+", "1"}], ";;", 
               RowBox[{"n", 
                RowBox[{"(", 
                 RowBox[{"n", "-", "1"}], ")"}]}]}], "]"}], "]"}], "]"}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"Sym", "[", 
            RowBox[{"[", 
             RowBox[{"cpos", "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}], "]"}], "]"}], "}"}]}], "]"}],
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Sym", "[", 
       RowBox[{"[", "Hpos", "]"}], "]"}]}], "\[IndentingNewLine]", ")"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CreateFiles", "[", "m_", "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"path", "=", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<Multiplier_Dim\>\"", "<>", 
       RowBox[{"ToString", "[", "m", "]"}], "<>", "\"\</\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"DirectoryQ", "[", "path", "]"}], ",", 
       RowBox[{"npath", "=", "path"}], ",", 
       RowBox[{"npath", "=", 
        RowBox[{"CreateDirectory", "[", "path", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pathSA", "=", 
      RowBox[{"path", "<>", "\"\<SA/\>\""}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pathPT", "=", 
      RowBox[{"path", "<>", "\"\<PT/\>\""}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"DirectoryQ", "[", "pathSA", "]"}], ",", "Nothing", ",", 
       RowBox[{"CreateDirectory", "[", "pathSA", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"DirectoryQ", "[", "pathPT", "]"}], ",", "Nothing", ",", 
       RowBox[{"CreateDirectory", "[", "pathPT", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Define", "[", "m", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"pathSA", "<>", "\"\<spinweights\>\"", "<>", 
        RowBox[{"ToString", "[", "m", "]"}], "<>", "\"\<.dat\>\""}], ",", 
       "spinweights", ",", "\"\<PythonExpression\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"pathSA", "<>", "\"\<JMat\>\"", "<>", 
        RowBox[{"ToString", "[", "m", "]"}], "<>", "\"\<.mtx\>\""}], ",", "J",
        ",", "\"\<MTX\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"pathSA", "<>", "\"\<HMat\>\"", "<>", 
        RowBox[{"ToString", "[", "m", "]"}], "<>", "\"\<.dat\>\""}], ",", 
       RowBox[{"H", "//", "N"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"pathSA", "<>", "\"\<const\>\"", "<>", 
        RowBox[{"ToString", "[", "m", "]"}], "<>", "\"\<.dat\>\""}], ",", 
       RowBox[{"co", "//", "N"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"pathPT", "<>", "\"\<spinweights\>\"", "<>", 
        RowBox[{"ToString", "[", "m", "]"}], "<>", "\"\<.dat\>\""}], ",", 
       "spinweights", ",", "\"\<PythonExpression\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"pathPT", "<>", "\"\<JMat\>\"", "<>", 
        RowBox[{"ToString", "[", "m", "]"}], "<>", "\"\<.mtx\>\""}], ",", "J",
        ",", "\"\<MTX\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"pathPT", "<>", "\"\<HMat\>\"", "<>", 
        RowBox[{"ToString", "[", "m", "]"}], "<>", "\"\<.dat\>\""}], ",", 
       RowBox[{"H", "//", "N"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"pathPT", "<>", "\"\<const\>\"", "<>", 
        RowBox[{"ToString", "[", "m", "]"}], "<>", "\"\<.dat\>\""}], ",", 
       RowBox[{"co", "//", "N"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
    ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InputOutputData", "[", 
   RowBox[{"d_", ",", "f_", ",", "n_", ",", "p_"}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"OutList", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"FnGlobal", "[", 
        RowBox[{"d", ",", "f"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"templist", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"in1", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"RandomChoice", "[", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"-", "1"}]}], "}"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "d"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"in2", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"RandomChoice", "[", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"-", "1"}]}], "}"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "d"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"out", "=", 
           RowBox[{"Propagate", "[", 
            RowBox[{"in1", ",", "in2"}], "]"}]}], ";", "\[IndentingNewLine]", 
          
          RowBox[{"AppendTo", "[", 
           RowBox[{"templist", ",", 
            RowBox[{"{", 
             RowBox[{"in1", ",", "in2", ",", "out"}], "}"}]}], "]"}], ";"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"pairs", ",", "1", ",", "p"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"OutList", ",", 
         RowBox[{"{", 
          RowBox[{"activefault", ",", "templist"}], "}"}]}], "]"}], ";"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"jn", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\</IOData/\>\"", 
       "<>", "\"\<D\>\"", "<>", 
       RowBox[{"ToString", "[", "d", "]"}], "<>", "\"\<_F\>\"", "<>", 
       RowBox[{"ToString", "[", "f", "]"}], "<>", "\"\<_N\>\"", "<>", 
       RowBox[{"ToString", "[", "n", "]"}], "<>", "\"\<_P\>\"", "<>", 
       RowBox[{"ToString", "[", "p", "]"}], "<>", "\"\<.dat\>\""}], ",", 
      "OutList", ",", "\"\<PythonExpression\>\""}], "]"}], ";"}], 
   "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.752342188839937*^9, {3.752342878793071*^9, 3.752342884888721*^9}, {
   3.752342966886219*^9, 3.7523429894692507`*^9}, {3.752416399717579*^9, 
   3.752416402908106*^9}, 3.752431301701078*^9, {3.752457554993788*^9, 
   3.752457558574999*^9}, {3.75245782431704*^9, 3.752457824858376*^9}, {
   3.752458112796424*^9, 3.75245811517032*^9}, {3.752626429405957*^9, 
   3.752626429557941*^9}, {3.7541590982854357`*^9, 3.754159252122527*^9}, {
   3.7541600579079037`*^9, 3.754160084186796*^9}, {3.7737694530844193`*^9, 
   3.7737694963675613`*^9}, {3.7737718727162457`*^9, 
   3.7737718857370443`*^9}, {3.773772021549131*^9, 3.773772025852098*^9}, {
   3.773772756972591*^9, 3.773772768867305*^9}, {3.77377324974446*^9, 
   3.773773270121213*^9}, {3.773773622859806*^9, 3.77377362310375*^9}, {
   3.7737778913783083`*^9, 3.773777895252474*^9}, {3.773778016928598*^9, 
   3.77377806266364*^9}, {3.773778104682313*^9, 3.773778142288287*^9}, {
   3.774918236544961*^9, 3.774918240175996*^9}, {3.774918648023355*^9, 
   3.7749189992196417`*^9}, {3.7749190297435703`*^9, 
   3.7749190718036423`*^9}, {3.774919129447754*^9, 3.7749191323466167`*^9}, {
   3.77491916600497*^9, 3.77491916659869*^9}, {3.774919278801564*^9, 
   3.7749193005078077`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"6319d99c-8ceb-4401-a04f-d9bd708d3df1"]
}, Closed]],

Cell[CellGroupData[{

Cell["Data Generated Here.", "Subsection",
 CellChangeTimes->{{3.773777903781186*^9, 
  3.773777910557629*^9}},ExpressionUUID->"09a70335-b8db-4a19-b6f8-\
921433c6764d"],

Cell[BoxData[{
 RowBox[{"CreateFiles", "[", "3", "]"}], "\[IndentingNewLine]", 
 RowBox[{"CreateFiles", "[", "4", "]"}], "\[IndentingNewLine]", 
 RowBox[{"CreateFiles", "[", "5", "]"}]}], "Input",
 CellChangeTimes->{
  3.752342188839937*^9, {3.752342878793071*^9, 3.752342884888721*^9}, {
   3.752342966886219*^9, 3.7523429894692507`*^9}, {3.752416399717579*^9, 
   3.752416402908106*^9}, 3.752431301701078*^9, {3.752457554993788*^9, 
   3.752457558574999*^9}, {3.75245782431704*^9, 3.752457824858376*^9}, {
   3.752458112796424*^9, 3.75245811517032*^9}, {3.752626429405957*^9, 
   3.752626429557941*^9}, {3.7541590982854357`*^9, 3.754159252122527*^9}, {
   3.7541600579079037`*^9, 3.754160084186796*^9}, {3.7737694530844193`*^9, 
   3.7737694963675613`*^9}, {3.7737718727162457`*^9, 
   3.7737718857370443`*^9}, {3.773772021549131*^9, 3.773772025852098*^9}, {
   3.773772756972591*^9, 3.773772768867305*^9}, {3.77377324974446*^9, 
   3.773773270121213*^9}, {3.773773622859806*^9, 3.77377362310375*^9}, {
   3.7737778913783083`*^9, 3.773777895252474*^9}, {3.773777940487348*^9, 
   3.773777940630315*^9}, {3.773778109033779*^9, 3.773778126526338*^9}, {
   3.774919338982971*^9, 3.774919350172827*^9}},
 CellLabel->
  "In[176]:=",ExpressionUUID->"ca03ce5b-4de7-4f8f-9505-8ac1d0e635d5"],

Cell[BoxData[{
 RowBox[{"CreateFiles", "[", "6", "]"}], "\[IndentingNewLine]", 
 RowBox[{"CreateFiles", "[", "7", "]"}], "\[IndentingNewLine]", 
 RowBox[{"CreateFiles", "[", "8", "]"}], "\[IndentingNewLine]", 
 RowBox[{"CreateFiles", "[", "9", "]"}], "\[IndentingNewLine]", 
 RowBox[{"CreateFiles", "[", "10", "]"}]}], "Input",
 CellChangeTimes->{{3.779000106449354*^9, 3.779000124342106*^9}},
 CellLabel->
  "In[157]:=",ExpressionUUID->"af37c03e-c94a-4657-bdf1-04fa973b22aa"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
  "(*", "\"\<Dimensions,Faults,Number of problems,Number of pairs per problem\
\>\"", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"n", "=", "3"}], ";", "\[IndentingNewLine]", 
     RowBox[{"InputOutputData", "[", 
      RowBox[{"n", ",", "f", ",", "10", ",", 
       RowBox[{"4", "n"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"f", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "n", ",", 
        RowBox[{"2", "n"}], ",", 
        RowBox[{"3", "n"}], ",", 
        RowBox[{"4", "n"}]}], "}"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7749192235906963`*^9, 3.774919259479611*^9}, {
  3.781448134051812*^9, 3.7814481985297623`*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"7b395727-0a30-4a16-ad1b-ff864ca8bbd5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"Null", ",", "Null", ",", "Null", ",", "Null", ",", "Null"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.781448207429291*^9},
 CellLabel->"Out[31]=",ExpressionUUID->"e0ca87ad-bdad-4bd7-9289-5c119f2ad4b8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"InputOutputData", "[", 
    RowBox[{"x", ",", 
     RowBox[{"x", "^", "2"}], ",", "50", ",", 
     RowBox[{"4", "*", "x"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "6", ",", "10"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.77900028793819*^9, 3.7790003229649677`*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"d791ea04-bf71-444a-8c85-07f96caee2e5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"Null", ",", "Null", ",", "Null", ",", "Null", ",", "Null"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.779000450077531*^9},
 CellLabel->"Out[56]=",ExpressionUUID->"9fa1d612-b215-4fc9-8107-26d1961e8af4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"244", "/", "261"}], "//", "N"}]], "Input",
 CellChangeTimes->{{3.781455522187677*^9, 3.781455527560399*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"63e94c98-fd53-4d82-bb9a-b976610f9449"],

Cell[BoxData["0.9348659003831418`"], "Output",
 CellChangeTimes->{{3.7814555251886053`*^9, 3.781455528130765*^9}},
 CellLabel->"Out[33]=",ExpressionUUID->"e905a1f4-5268-48a7-b7be-cb5160a9c229"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"1", "-", ".06667"}]], "Input",
 CellChangeTimes->{{3.7814555334575768`*^9, 3.78145554065864*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"23197523-47e8-4fd1-8723-666f806956bc"],

Cell[BoxData["0.93333`"], "Output",
 CellChangeTimes->{{3.7814555350054483`*^9, 3.781455541103633*^9}},
 CellLabel->"Out[36]=",ExpressionUUID->"91cdbb93-3c6a-4b87-8c32-97d92880af3c"]
}, Open  ]],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.7790099733536043`*^9},ExpressionUUID->"8802b650-0604-4172-beb0-\
54d5cc7e93c7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"hm", "[", "5", "]"}]], "Input",
 CellChangeTimes->{{3.779010053610126*^9, 3.7790100536695223`*^9}, {
  3.7790100975754023`*^9, 3.779010098268804*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"5542f1d0-b7e2-4561-b13b-be5a59ba1321"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["SparseArray",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource[
               "FEBitmaps", "SquarePlusIconMedium"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              Evaluator -> Automatic, Method -> "Preemptive"], 
             Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[
             RasterBox[CompressedData["
1:eJxTTMoPSmVmYGBgBGI5IAaxFd6HagvXHbVngAKRLScfTva7bH/+ntBRRsaL
9ml9C3cLOp62f3FRQ3ZZ9XN75kPflTrNLtjfvMt632vBBftt+07fTTvxwt5m
i855D//z9nMnGS9T2nfJ/lvt7kO2m1/SXPyR5Ib+yT/O2mtuUtE582iuPTt3
L8uSzjv210U3Kt1PvmjPZOM3wSV7uf0mnTU+LI8f2K/hSbq+7cNF+0Nq6z5o
qB+xX/zC1Hjzx6f2R34KvhAqPG2fN99pY9aPKfbmHhm1G0/ctG9pvm25zfWi
vUXGypzM8Ef2huf+H5/0+a29x7T4UMf1D+1zek/wyl56aR+S4rItbPp7+5ge
2+kMy4DhE7KixV3ugX2QTcP+Nta39l+OzPu3c+9Fe41eaU5x5if2XlMP95Ys
e2ff+Efp72m3C/bPOO/rsU67a//tcmHy/PI39tPCksz8Lt60L+utyNFyem5f
Vfu5KyH8Pc3FV/ucLtjKcd7+7sFFt0x1btiv+NCbcC70Nc3FOxYct65vumzf
kxE++/vjdfZ5TLGhJwwfkywOAET8b08=
              "], {{0, 0}, {30, 1}}, {0, 1}],
              AspectRatio -> 1, Axes -> False, Frame -> False, 
             FrameLabel -> {None, None}, FrameStyle -> Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
             Directive[
               GrayLevel[0.5, 0.4]], ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], 
             Method -> {
              "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> 
               Automatic, 
               "DefaultGraphicsInteraction" -> {
                "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                 "Effects" -> {
                  "Highlight" -> {"ratio" -> 2}, 
                   "HighlightPoint" -> {"ratio" -> 2}, 
                   "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
               "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
               Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["450", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", "450", "}"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource[
               "FEBitmaps", "SquareMinusIconMedium"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              Evaluator -> Automatic, Method -> "Preemptive"], 
             Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[
             RasterBox[CompressedData["
1:eJxTTMoPSmVmYGBgBGI5IAaxFd6HagvXHbVngAKRLScfTva7bH/+ntBRRsaL
9ml9C3cLOp62f3FRQ3ZZ9XN75kPflTrNLtjfvMt632vBBftt+07fTTvxwt5m
i855D//z9nMnGS9T2nfJ/lvt7kO2m1/SXPyR5Ib+yT/O2mtuUtE582iuPTt3
L8uSzjv210U3Kt1PvmjPZOM3wSV7uf0mnTU+LI8f2K/hSbq+7cNF+0Nq6z5o
qB+xX/zC1Hjzx6f2R34KvhAqPG2fN99pY9aPKfbmHhm1G0/ctG9pvm25zfWi
vUXGypzM8Ef2huf+H5/0+a29x7T4UMf1D+1zek/wyl56aR+S4rItbPp7+5ge
2+kMy4DhE7KixV3ugX2QTcP+Nta39l+OzPu3c+9Fe41eaU5x5if2XlMP95Ys
e2ff+Efp72m3C/bPOO/rsU67a//tcmHy/PI39tPCksz8Lt60L+utyNFyem5f
Vfu5KyH8Pc3FV/ucLtjKcd7+7sFFt0x1btiv+NCbcC70Nc3FOxYct65vumzf
kxE++/vjdfZ5TLGhJwwfkywOAET8b08=
              "], {{0, 0}, {30, 1}}, {0, 1}],
              AspectRatio -> 1, Axes -> False, Frame -> False, 
             FrameLabel -> {None, None}, FrameStyle -> Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
             Directive[
               GrayLevel[0.5, 0.4]], ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], 
             Method -> {
              "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> 
               Automatic, 
               "DefaultGraphicsInteraction" -> {
                "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                 "Effects" -> {
                  "Highlight" -> {"ratio" -> 2}, 
                   "HighlightPoint" -> {"ratio" -> 2}, 
                   "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
               "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
               Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["450", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", "450", "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["0", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1.`", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["\"\"", "SummaryItem"]}]}, {
               TagBox[
                TagBox[
                 GridBox[{{
                    RowBox[{
                    RowBox[{"{", "333", "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    FractionBox["1", "2"], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", "270", "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    FractionBox["3", "2"], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", "65", "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{"-", 
                    FractionBox["1", "4"]}], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", "2", "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{"-", 
                    FractionBox["15", "4"]}], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    ItemBox[
                    "\"\[VerticalEllipsis]\"", Alignment -> Center, 
                    StripOnInput -> False]}}, 
                  GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                  DefaultBaseStyle -> "Column", 
                  GridBoxItemSize -> {
                   "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                 "Column"], "SummaryItem"]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  SparseArray[Automatic, {450}, 0, {1, {{0, 450}, CompressedData["
1:eJwt1Ae4jmUcBvBTQsnICilCCaFhi0iKjIyIRCRZhawGFRFFZqKhkFlmNKxK
2nvvvffeu373Vdfl577/z/udc97v+Z73qzZwVPeRexYUFNy/R0GBfwWd/VeS
4/Ssr9afkHWZog+S7WnCKO61NpKeHG9eKgfnZ2V77uAt8xCepDqz+ZUKuS4/
53XWm/uwldvMzeQb8iD5jLyUE+hnflGOYKz+kzxTdpX98xp9IkdwubksN+ul
KEY58zg+pDQlqWN9EeX1u/N6/qaDtQvZwDxzNukVcd//ezaTJXpXOYbb9a9Y
xim5Lz7Na2lFIR5nH4pQmQZ+rizT9BtkI9pQhpZcxt6uHUJbvbjckVvR58ru
zNcXy0ryUXmuPIDX9PKyE3vpbdjKRebtbNLnyaGyHifRkuXWGssfmap3kN3k
nfkc5C5Zm136Ci7W3+EXjmIj11ivx7LsC1dYe5dy+Xz5Ut8sR3F0zlLePys4
0do9vKyP5GT9QPkQP9Pa3ECu4iweZKW1P2VveVXoO9mtPywvyJmQE+mYfZWl
eJNt5mb5O2xnA12s3ZTzR32u5D1KMNi12byUvcx+08s8LJ+TfFW+QF9qmdfI
Q+UUeT2L9dbZI77NmTMfJpvKdnKJPDXPVJ5FPrJ2mpwvezJMP4OF+vdM4hYO
traKvrl3JtODWq7dJWfJY/iAqtmTnFPrT+VMy+ayYV6bs2CenrOa80dFrqYJ
k+jiWrU8H3IpnShs/kE2lkMoqp/DdTxG8XzW1Gaqea4swm/6Is5jS/bIWjV5
vmzFRtZRmX2tD2AGA81/JRnLAvPOnEeONA/NdwAP6MfK/bKPnK3vlqsL/vve
650zR42ccbbk/JnHME7/WFZkuD4h9ymfldPkF3ImE/Tn5ULZMPdJYXMl2uk1
ZNE8l3JN7o8bc0/8nvdKc72b/IdZ+nLZI/ebc57Xy+eyp/oMCrEgZ4vu+iV5
/uToPO8czjZrO+T78nS5Vu4vS+e6/gff8TabrLWgV/aLp6nDOj6hH2vzLDNc
b8StORfyG77OnHOYz9z6IJrqo5mcs2euT029Iyupbu4j58gRVKWzeTOf5V6Z
bm1AznyeQ1lGXivrMp4qOf9yTt4j/fM88YhegfGUMBeT66mS50vWzJ7lu4W2
5hb5vfwLD0fMnw==
     "]}, {
     Rational[1, 2], 
     Rational[3, 2], 
     Rational[-1, 4], 
     Rational[-15, 4], -1, 2, 
     Rational[-1, 4], 
     Rational[1, 2], 
     Rational[-1, 4], 
     Rational[1, 4], 
     Rational[-1, 4], 
     Rational[-1, 4], -1, 
     Rational[1, 2], 
     Rational[1, 2], 
     Rational[1, 4], 
     Rational[-5, 4], 
     Rational[1, 4], 2, 2, 
     Rational[-5, 4], 
     Rational[1, 2], 
     Rational[-1, 4], 2, 
     Rational[-1, 4], -2, 
     Rational[1, 2], 1, -2, 
     Rational[1, 2], 
     Rational[1, 2], -1, 
     Rational[1, 2], 
     Rational[-5, 4], -2, 2, 
     Rational[1, 2], 
     Rational[3, 2], 2, -2, 
     Rational[1, 4], 
     Rational[-1, 2], 
     Rational[1, 2], 
     Rational[1, 4], 
     Rational[1, 2], 1, 
     Rational[1, 2], 
     Rational[-1, 4], 
     Rational[-1, 4], 
     Rational[3, 2], 
     Rational[-1, 2], 2, -2, 
     Rational[-1, 4], 
     Rational[-5, 4], 2, 2, 
     Rational[-1, 4], 
     Rational[-1, 4], 
     Rational[1, 2], 
     Rational[-1, 4], 
     Rational[-1, 4], 2, 
     Rational[-5, 4], 
     Rational[-1, 4], 2, -1, 
     Rational[1, 2], 
     Rational[3, 2], 
     Rational[1, 2], 
     Rational[-5, 4], -2, 2, 
     Rational[1, 2], 2, 
     Rational[-5, 4], 
     Rational[-1, 2], 
     Rational[1, 4], 
     Rational[1, 2], 
     Rational[1, 2], -2, 1, -1, 
     Rational[-1, 4], 
     Rational[1, 4], 
     Rational[1, 2], 2, 
     Rational[-1, 4], 
     Rational[-15, 4], 2, 
     Rational[-15, 4], 
     Rational[-15, 4], 
     Rational[-1, 4], 1, 
     Rational[3, 2], -2, -1, 1, 1, 1, 1, 
     Rational[1, 2], 
     Rational[-15, 4], 
     Rational[-1, 4], 1, 
     Rational[-1, 4], 2, 1, -2, 
     Rational[1, 4], 
     Rational[1, 2], -1, 2, 2, 
     Rational[-1, 2], 1, 
     Rational[1, 2], 1, 
     Rational[-1, 2], 
     Rational[-15, 4], 
     Rational[-1, 4], -2, 
     Rational[-1, 2], 
     Rational[-5, 4], -2, 
     Rational[1, 2], 
     Rational[1, 4], 
     Rational[1, 4], 
     Rational[-1, 4], 
     Rational[-1, 4], 
     Rational[-5, 4], 
     Rational[1, 4], 2, 
     Rational[-1, 2], 
     Rational[1, 4], 
     Rational[-1, 2], -2, 
     Rational[-1, 2], 2, 
     Rational[1, 4], 
     Rational[-5, 4], -1, -2, 
     Rational[1, 2], 
     Rational[-1, 2], 
     Rational[1, 4], -2, 
     Rational[-1, 2], 2, -1, 
     Rational[-5, 4], -2, 
     Rational[1, 2], 2, 
     Rational[-5, 4], 2, 
     Rational[-5, 4], 
     Rational[-1, 2], 
     Rational[-1, 4], 2, 
     Rational[1, 4], 
     Rational[1, 4], 2, 
     Rational[-5, 4], 
     Rational[1, 2], 
     Rational[-1, 4], 
     Rational[-1, 2], 
     Rational[-1, 4], 2, 
     Rational[1, 2], 
     Rational[3, 2], 
     Rational[-1, 4], 
     Rational[1, 4], 
     Rational[1, 4], 2, 
     Rational[-5, 4], 
     Rational[1, 2], 
     Rational[-1, 2], 
     Rational[1, 2], -2, 2, -1, 2, 
     Rational[1, 2], 
     Rational[1, 4], -2, 
     Rational[1, 2], -2, 
     Rational[-1, 4], 
     Rational[1, 2], -1, 
     Rational[1, 4], 
     Rational[-1, 4], 
     Rational[-3, 4], -2, 
     Rational[1, 2], -1, 
     Rational[-1, 4], 
     Rational[-1, 4], -2, 
     Rational[1, 2], 
     Rational[-1, 4], 
     Rational[1, 2], 
     Rational[-1, 2], 
     Rational[1, 2], 
     Rational[-3, 4], 
     Rational[-1, 4], 
     Rational[1, 2], 
     Rational[-1, 4], 1, 
     Rational[1, 2], 
     Rational[1, 2], 
     Rational[1, 4], 2, -2, 2, -2, -1, 
     Rational[-5, 4], 
     Rational[1, 4], -1, 2, 
     Rational[-5, 4], 
     Rational[1, 4], 1, 
     Rational[-1, 4], 
     Rational[-5, 4], 
     Rational[-1, 2], 2, 2, 
     Rational[1, 2], 
     Rational[1, 2], -2, 
     Rational[-1, 4], 
     Rational[1, 2], 
     Rational[1, 2], -1, 2, -2, -2, 2, 
     Rational[-5, 4], 
     Rational[1, 2], -1, 
     Rational[-1, 2], 
     Rational[1, 2], 
     Rational[-1, 4], 
     Rational[-5, 4], -2, 
     Rational[1, 4], 
     Rational[1, 2], 
     Rational[-1, 4], 
     Rational[1, 4], 
     Rational[-1, 2], 2, 
     Rational[-5, 4], 
     Rational[-1, 4], 
     Rational[1, 4], -2, 1, -2, 
     Rational[3, 2], 1, 
     Rational[3, 2], 
     Rational[-1, 2], 2, 
     Rational[1, 2], 
     Rational[1, 4], 1, 
     Rational[-1, 4], -1, 
     Rational[-1, 4], 2, 1, 
     Rational[3, 2], 
     Rational[-1, 2], 
     Rational[-15, 4], 
     Rational[1, 4], -1, 2, 2, 2, 1, -2, 
     Rational[-1, 2], 1, 
     Rational[-1, 2], 
     Rational[1, 4], 
     Rational[1, 4], -2, 
     Rational[-5, 4], 
     Rational[-1, 4], 
     Rational[-1, 2], 1, 
     Rational[-5, 4], 
     Rational[-5, 4], 2, 
     Rational[-1, 4], 
     Rational[-1, 4], -2, 
     Rational[-1, 2], 
     Rational[-1, 2], 
     Rational[-1, 4], 
     Rational[-1, 4], 
     Rational[1, 2], -1, 
     Rational[1, 2], 
     Rational[-1, 4], 
     Rational[1, 2], 
     Rational[1, 2], 2, 2, 
     Rational[-1, 4], 
     Rational[1, 4], 
     Rational[-1, 2], 2, -2, 
     Rational[-15, 4], 
     Rational[-1, 4], 
     Rational[-1, 4], 2, -1, -1, 2, 
     Rational[1, 4], 
     Rational[-1, 2], 
     Rational[1, 2], 
     Rational[-1, 4], 
     Rational[-1, 2], -2, 
     Rational[1, 2], 2, 
     Rational[-1, 2], 
     Rational[1, 2], -2, 
     Rational[1, 2], 2, 
     Rational[1, 2], 2, 1, 
     Rational[-15, 4], 
     Rational[-1, 4], 1, 
     Rational[-1, 4], 2, 
     Rational[-1, 4], 
     Rational[-5, 4], 1, 
     Rational[-5, 4], 1, 
     Rational[1, 2], 
     Rational[-1, 4], 1, 
     Rational[-1, 4], 
     Rational[-1, 2], 
     Rational[1, 2], 
     Rational[1, 4], 
     Rational[1, 4], 
     Rational[-1, 4], 
     Rational[1, 2], -1, 2, 
     Rational[1, 2], 
     Rational[1, 2], 1, -1, 
     Rational[1, 4], 
     Rational[1, 2], -2, 
     Rational[3, 2], 
     Rational[-1, 2], 
     Rational[3, 2], 1, -2, 
     Rational[-5, 4], 
     Rational[1, 2], 
     Rational[-1, 2], -2, 2, 2, 
     Rational[1, 4], 
     Rational[-1, 2], 1, 
     Rational[1, 2], -1, 2, 
     Rational[1, 4], 
     Rational[1, 4], 2, 
     Rational[-1, 4], -2, 
     Rational[1, 2], 
     Rational[-1, 4], 
     Rational[-5, 4], 
     Rational[1, 2], 
     Rational[-1, 4], 
     Rational[-1, 4], -1, 
     Rational[1, 4], 1, 2, -2, 
     Rational[-1, 4], 
     Rational[-5, 4], 
     Rational[1, 2], 
     Rational[-1, 4], 
     Rational[-1, 4], -2, 
     Rational[3, 2], 1, 
     Rational[-1, 4], 
     Rational[-1, 4], 
     Rational[1, 4], 
     Rational[3, 2], 
     Rational[-1, 4], 
     Rational[1, 2], 
     Rational[1, 2], 1, 
     Rational[1, 4], -2, 
     Rational[1, 2], 
     Rational[-1, 4], 
     Rational[1, 2], 
     Rational[-1, 2], 
     Rational[1, 4], 
     Rational[-1, 2], 
     Rational[-1, 4], -1, 
     Rational[3, 2], 
     Rational[1, 2], 
     Rational[-1, 4], 
     Rational[-5, 4], -2, 
     Rational[-1, 4], 
     Rational[1, 2], 
     Rational[3, 2], 2, 
     Rational[-1, 4], 
     Rational[1, 4], 1, 
     Rational[-15, 4], -2, 2, 
     Rational[-1, 4], 1, 
     Rational[1, 2], 1, 
     Rational[-1, 4], 
     Rational[-1, 4], -1}}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{
  3.779010054202387*^9, {3.779010096142424*^9, 3.779010098722123*^9}},
 CellLabel->"Out[32]=",ExpressionUUID->"1621e376-4144-4aaf-890a-443f28dfcfce"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"m", "=", "8"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Jt", "=", 
   RowBox[{"Jm", "[", "m", "]"}]}], ";", 
  RowBox[{"Ht", "=", 
   RowBox[{"hm", "[", "m", "]"}]}], ";", 
  RowBox[{"c", "=", 
   RowBox[{"const", "[", "m", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RandomChoice", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"-", "1"}]}], "}"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"24", 
        RowBox[{"m", "^", "2"}]}], "-", 
       RowBox[{"30", "m"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v", ".", "Jt", ".", "v"}], "+", 
  RowBox[{"Ht", ".", "v"}], "+", "c"}]}], "Input",
 CellChangeTimes->{{3.779009955646461*^9, 3.77901004752431*^9}, {
  3.77901010377721*^9, 3.779010133158782*^9}},
 CellLabel->
  "In[153]:=",ExpressionUUID->"44f32573-342a-4bc3-a9a9-d775aee75088"],

Cell[BoxData["1848"], "Output",
 CellChangeTimes->{{3.779010013897444*^9, 3.779010047960267*^9}, {
  3.7790101011266527`*^9, 3.779010137660643*^9}},
 CellLabel->
  "Out[156]=",ExpressionUUID->"c50a9511-6e2d-4738-8521-61aa75439378"]
}, Open  ]],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.779009987180442*^9},ExpressionUUID->"f78c35b0-bd29-4f6c-a4fa-\
b89d15ec3bd5"]
}, Open  ]]
},
WindowSize->{824, 400},
WindowMargins->{{Automatic, 3}, {Automatic, 0}},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 166, 3, 54, "Subsection",ExpressionUUID->"3361d236-868b-4318-82da-54f6b0af1603"],
Cell[749, 27, 155786, 4248, 9563, "Input",ExpressionUUID->"6319d99c-8ceb-4401-a04f-d9bd708d3df1"]
}, Closed]],
Cell[CellGroupData[{
Cell[156572, 4280, 168, 3, 38, "Subsection",ExpressionUUID->"09a70335-b8db-4a19-b6f8-921433c6764d"],
Cell[156743, 4285, 1284, 20, 73, "Input",ExpressionUUID->"ca03ce5b-4de7-4f8f-9505-8ac1d0e635d5"],
Cell[158030, 4307, 476, 8, 115, "Input",ExpressionUUID->"af37c03e-c94a-4657-bdf1-04fa973b22aa"],
Cell[CellGroupData[{
Cell[158531, 4319, 820, 21, 73, "Input",ExpressionUUID->"7b395727-0a30-4a16-ad1b-ff864ca8bbd5"],
Cell[159354, 4342, 242, 5, 34, "Output",ExpressionUUID->"e0ca87ad-bdad-4bd7-9289-5c119f2ad4b8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[159633, 4352, 428, 10, 30, "Input",ExpressionUUID->"d791ea04-bf71-444a-8c85-07f96caee2e5"],
Cell[160064, 4364, 242, 5, 34, "Output",ExpressionUUID->"9fa1d612-b215-4fc9-8107-26d1961e8af4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[160343, 4374, 222, 4, 30, "Input",ExpressionUUID->"63e94c98-fd53-4d82-bb9a-b976610f9449"],
Cell[160568, 4380, 193, 2, 34, "Output",ExpressionUUID->"e905a1f4-5268-48a7-b7be-cb5160a9c229"]
}, Open  ]],
Cell[CellGroupData[{
Cell[160798, 4387, 200, 3, 30, "Input",ExpressionUUID->"23197523-47e8-4fd1-8723-666f806956bc"],
Cell[161001, 4392, 182, 2, 34, "Output",ExpressionUUID->"91cdbb93-3c6a-4b87-8c32-97d92880af3c"]
}, Open  ]],
Cell[161198, 4397, 149, 3, 52, "Input",ExpressionUUID->"8802b650-0604-4172-beb0-54d5cc7e93c7"],
Cell[CellGroupData[{
Cell[161372, 4404, 253, 4, 30, "Input",ExpressionUUID->"5542f1d0-b7e2-4561-b13b-be5a59ba1321"],
Cell[161628, 4410, 18819, 524, 62, "Output",ExpressionUUID->"1621e376-4144-4aaf-890a-443f28dfcfce"]
}, Open  ]],
Cell[CellGroupData[{
Cell[180484, 4939, 992, 30, 94, "Input",ExpressionUUID->"44f32573-342a-4bc3-a9a9-d775aee75088"],
Cell[181479, 4971, 231, 4, 34, "Output",ExpressionUUID->"c50a9511-6e2d-4738-8521-61aa75439378"]
}, Open  ]],
Cell[181725, 4978, 147, 3, 52, "Input",ExpressionUUID->"f78c35b0-bd29-4f6c-a4fa-b89d15ec3bd5"]
}, Open  ]]
}
]
*)

